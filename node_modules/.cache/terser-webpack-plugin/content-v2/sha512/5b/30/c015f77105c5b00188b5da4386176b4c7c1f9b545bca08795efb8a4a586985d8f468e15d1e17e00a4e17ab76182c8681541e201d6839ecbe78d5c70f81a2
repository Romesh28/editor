{"code":"!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=11)}([function(e,t,r){\"use strict\";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(e){if(\"string\"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===r&&e.constructor&&(r=e.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t,r=1;r<arguments.length;r++)t=null==arguments[r]?{}:arguments[r],r%2?a(Object(t),!0).forEach(function(r){s(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))});return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){return e===\"</\"+t+\">\"}function l(e,t){return 0===e.indexOf(\"<\"+t)&&-1!==[\">\",\" \",\"/\"].indexOf(e[t.length+1])}function c(e,t,r){\"string\"==typeof t&&(t=[t]);for(var n,o=1,a=r,i=e.length;a<i;a++){n=e[a];for(var s,c=0,p=t.length;c<p;c++)if(s=t[c],u(n.value,s)&&o--,l(n.value,s)&&o++,0==o)return a}return null}function p(e,t,r){\"string\"==typeof t&&(t=[t]);for(var n,o=1,a=r;0<=a;a--){n=e[a];for(var i,s=0,c=t.length;s<c;s++)if(i=t[s],l(n.value,i)&&o--,u(n.value,i)&&o++,0==o)return a}return null}function f(e,t){var r=t.type,n=t.tag,o=t.position;return\"tag\"===r&&n===e&&\"start\"===o}function h(e,t){var r=t.type,n=t.tag,o=t.position;return\"tag\"===r&&n===e&&\"end\"===o}var d=r(12),m=d.DOMParser,g=d.XMLSerializer,v=r(1).throwXmlTagNotFound,y=r(4),b=y.last,x=y.first,w={},T=[[\"&\",\"&amp;\"],[\"<\",\"&lt;\"],[\">\",\"&gt;\"],['\"',\"&quot;\"],[\"'\",\"&apos;\"]],E=T.map(function(e){var t=n(e,2),r=t[0],o=t[1];return{rstart:new RegExp(o,\"g\"),rend:new RegExp(r,\"g\"),start:o,end:r}}),O=/Â /g,N=/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]/;e.exports={endsWith:function(e,t){return-1!==e.indexOf(t,e.length-t.length)},startsWith:function(e,t){return e.substring(0,t.length)===t},isContent:function(e){var t=e.type,r=e.position;return\"placeholder\"===t||\"content\"===t&&\"insidetag\"===r},isParagraphStart:function(e){return f(\"w:p\",e)||f(\"a:p\",e)},isParagraphEnd:function(e){return h(\"w:p\",e)||h(\"a:p\",e)},isTagStart:function(e,t){var r=t.type,n=t.tag,o=t.position;return\"tag\"===r&&n===e&&(\"start\"===o||\"selfclosing\"===o)},isTagEnd:h,isTextStart:function(e){var t=e.type,r=e.position,n=e.text;return\"tag\"===t&&\"start\"===r&&n},isTextEnd:function(e){var t=e.type,r=e.position,n=e.text;return\"tag\"===t&&\"end\"===r&&n},isStarting:l,isEnding:u,isModule:function(e,t){var r=e.module,n=e.type;return t instanceof Array||(t=[t]),\"placeholder\"===n&&-1!==t.indexOf(r)},uniq:function(e){for(var t={},r=[],n=0,o=e.length;n<o;++n)t[e[n]]||(t[e[n]]=!0,r.push(e[n]));return r},chunkBy:function(e,t){return e.reduce(function(e,r){var n=b(e),o=t(r);return\"start\"===o?e.push([r]):\"end\"===o?(n.push(r),e.push([])):n.push(r),e},[[]]).filter(function(e){return 0<e.length})},last:b,first:x,mergeObjects:function(){for(var e,t={},r=0;r<arguments.length;r+=1)e=arguments[r],t=i(i({},t),e);return t},xml2str:function(e){return(new g).serializeToString(e).replace(/xmlns(:[a-z0-9]+)?=\"\" ?/g,\"\")},str2xml:function(e){return 65279===e.charCodeAt(0)&&(e=e.substr(1)),(new m).parseFromString(e,\"text/xml\")},getRightOrNull:c,getRight:function(e,t,r){var n=c(e,t,r);return null===n?void v({position:\"right\",element:t,parsed:e,index:r}):n},getLeftOrNull:p,getLeft:function(e,t,r){var n=p(e,t,r);return null===n?void v({position:\"left\",element:t,parsed:e,index:r}):n},pregMatchAll:function(e,t){for(var r,n=[];null!=(r=e.exec(t));)n.push({array:r,offset:r.index});return n},convertSpaces:function(e){return e.replace(O,\" \")},charMapRegexes:E,hasCorruptCharacters:function(e){return N.test(e)},defaults:{errorLogging:\"json\",paragraphLoop:!1,nullGetter:function(e){return e.module?\"\":\"undefined\"},xmlFileNames:[\"[Content_Types].xml\"],parser:function(e){return{get:function(t){return\".\"===e?t:t[e]}}},linebreaks:!1,fileTypeConfig:null,delimiters:{start:\"{\",end:\"}\"}},wordToUtf8:function(e){for(var t,r=E.length-1;0<=r;r--)t=E[r],e=e.replace(t.rstart,t.end);return e},utf8ToWord:function(e){e=e.toString();for(var t,r=0,n=E.length;r<n;r++)t=E[r],e=e.replace(t.rend,t.start);return e},concatArrays:function(e){for(var t,r=[],n=0;n<e.length;n++)for(var o=0,a=(t=e[n]).length;o<a;o++)r.push(t[o]);return r},invertMap:function(e){return Object.keys(e).reduce(function(t,r){var n=e[r];return t[n]=t[n]||[],t[n].push(r),t},{})},charMap:T,getSingleAttribute:function(e,t){var r=e.indexOf(\" \".concat(t,'=\"'));if(-1===r)return null;var n=e.substr(r).search(/[\"']/)+r,o=e.substr(n+1).search(/[\"']/)+n;return e.substr(n+1,o-n)},setSingleAttribute:function(e,t,r){var n;if(w[t]?n=w[t]:(n=new RegExp(\"(<.* \".concat(t,'=\")([^\"]*)(\".*)$')),w[t]=n),n.test(e))return e.replace(n,\"$1\".concat(r,\"$3\"));var o=e.lastIndexOf(\"/>\");return-1===o&&(o=e.lastIndexOf(\">\")),e.substr(0,o)+\" \".concat(t,'=\"').concat(r,'\"')+e.substr(o)},isWhiteSpace:function(e){return/^[ \\n\\r\\t]+$/.test(e)}}},function(e,t,r){\"use strict\";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){this.name=\"GenericError\",this.message=e,this.stack=new Error(e).stack}function i(e){this.name=\"TemplateError\",this.message=e,this.stack=new Error(e).stack}function s(e){this.name=\"RenderingError\",this.message=e,this.stack=new Error(e).stack}function u(e){this.name=\"ScopeParserError\",this.message=e,this.stack=new Error(e).stack}function l(e){this.name=\"InternalError\",this.properties={explanation:\"InternalError\"},this.message=e,this.stack=new Error(e).stack}function c(e){this.name=\"APIVersionError\",this.properties={explanation:\"APIVersionError\"},this.message=e,this.stack=new Error(e).stack}var p=r(4),f=p.last,h=p.first;a.prototype=Error.prototype,i.prototype=new a,s.prototype=new a,u.prototype=new a,l.prototype=new a,c.prototype=new a,e.exports={XTError:a,XTTemplateError:i,XTInternalError:l,XTScopeParserError:u,XTAPIVersionError:c,RenderingError:s,XTRenderingError:s,getClosingTagNotMatchOpeningTag:function(e){var t=e.tags,r=new i(\"Closing tag does not match opening tag\");return r.properties={id:\"closing_tag_does_not_match_opening_tag\",explanation:'The tag \"'.concat(t[0].value,'\" is closed by the tag \"').concat(t[1].value,'\"'),openingtag:h(t).value,offset:[h(t).offset,f(t).offset],closingtag:f(t).value},r},getLoopPositionProducesInvalidXMLError:function(e){var t=e.tag,r=e.offset,n=new i('The position of the loop tags \"'.concat(t,'\" would produce invalid XML'));return n.properties={xtag:t,id:\"loop_position_invalid\",explanation:'The tags \"'.concat(t,'\" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:r},n},getScopeCompilationError:function(e){var t=e.tag,r=e.rootError,n=e.offset,o=new u(\"Scope parser compilation failed\");return o.properties={id:\"scopeparser_compilation_failed\",offset:n,xtag:t,explanation:'The scope parser for the tag \"'.concat(t,'\" failed to compile'),rootError:r},o},getScopeParserExecutionError:function(e){var t=e.tag,r=e.scope,n=e.error,o=e.offset,a=new u(\"Scope parser execution failed\");return a.properties={id:\"scopeparser_execution_failed\",explanation:\"The scope parser for the tag \".concat(t,\" failed to execute\"),scope:r,offset:o,xtag:t,rootError:n},a},getUnclosedTagException:function(e){var t=new i(\"Unclosed tag\");return t.properties={xtag:h(e.xtag.split(\" \")).substr(1),id:\"unclosed_tag\",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with \"'.concat(e.xtag.substr(0,10),'\" is unclosed')},t},getUnopenedTagException:function(e){var t=new i(\"Unopened tag\");return t.properties={xtag:f(e.xtag.split(\" \")),id:\"unopened_tag\",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with \"'.concat(e.xtag.substr(0,10),'\" is unopened')},t},getUnmatchedLoopException:function(e){var t=e.location,r=e.offset,n=\"start\"===t?\"unclosed\":\"unopened\",o=new i(\"\".concat(\"start\"===t?\"Unclosed\":\"Unopened\",\" loop\")),a=e.value;return o.properties={id:\"\".concat(n,\"_loop\"),explanation:'The loop with tag \"'.concat(a,'\" is ').concat(n),xtag:a,offset:r},o},getDuplicateCloseTagException:function(e){var t=new i(\"Duplicate close tag, expected one close tag\");return t.properties={xtag:h(e.xtag.split(\" \")),id:\"duplicate_close_tag\",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag ending with \"'.concat(e.xtag.substr(0,10),'\" has duplicate close tags')},t},getDuplicateOpenTagException:function(e){var t=new i(\"Duplicate open tag, expected one open tag\");return t.properties={xtag:h(e.xtag.split(\" \")),id:\"duplicate_open_tag\",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with \"'.concat(e.xtag.substr(0,10),'\" has duplicate open tags')},t},getCorruptCharactersException:function(e){var t=e.tag,r=e.value,n=e.offset,o=new s(\"There are some XML corrupt characters\");return o.properties={id:\"invalid_xml_characters\",xtag:t,value:r,offset:n,explanation:\"There are some corrupt characters for the field \".concat(t)},o},getInvalidRawXMLValueException:function(e){var t=e.tag,r=e.value,n=e.offset,o=new s(\"Non string values are not allowed for rawXML tags\");return o.properties={id:\"invalid_raw_xml_value\",xtag:t,value:r,offset:n,explanation:\"The value of the raw tag : '\".concat(t,\"' is not a string\")},o},getUnbalancedLoopException:function(e,t){var r=new i(\"Unbalanced loop tag\"),n=t[0].part.value,o=t[1].part.value,a=e[0].part.value,s=e[1].part.value;return r.properties={id:\"unbalanced_loop_tags\",explanation:\"Unbalanced loop tags {#\".concat(n,\"}{/\").concat(o,\"}{#\").concat(a,\"}{/\").concat(s,\"}\"),offset:[t[0].part.offset,e[1].part.offset],lastPair:{left:t[0].part.value,right:t[1].part.value},pair:{left:e[0].part.value,right:e[1].part.value}},r},throwApiVersionError:function(e,t){var r=new c(e);throw r.properties=function(e){for(var t,r=1;r<arguments.length;r++)t=null==arguments[r]?{}:arguments[r],r%2?n(Object(t),!0).forEach(function(r){o(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))});return e}({id:\"api_version_error\"},t),r},throwFileTypeNotHandled:function(e){var t=new l('The filetype \"'.concat(e,'\" is not handled by docxtemplater'));throw t.properties={id:\"filetype_not_handled\",explanation:'The file you are trying to generate is of type \"'.concat(e,'\", but only docx and pptx formats are handled'),fileType:e},t},throwFileTypeNotIdentified:function(){var e=new l(\"The filetype for this file could not be identified, is this file corrupted ?\");throw e.properties={id:\"filetype_not_identified\",explanation:\"The filetype for this file could not be identified, is this file corrupted ?\"},e},throwMalformedXml:function(){var e=new l(\"Malformed xml\");throw e.properties={explanation:\"The template contains malformed xml\",id:\"malformed_xml\"},e},throwMultiError:function(e){var t=new i(\"Multi error\");throw t.properties={errors:e,id:\"multi_error\",explanation:\"The template has multiple errors\"},t},throwExpandNotFound:function(e){var t=e.part,r=t.value,n=t.offset,o=e.id,a=void 0===o?\"raw_tag_outerxml_invalid\":o,s=e.message,u=void 0===s?\"Raw tag not in paragraph\":s,l=e.part,c=e.explanation,p=void 0===c?'The tag \"'.concat(r,'\" is not inside a paragraph'):c;\"function\"==typeof p&&(p=p(l));var f=new i(u);throw f.properties={id:a,explanation:p,rootError:e.rootError,xtag:r,offset:n,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},f},throwRawTagShouldBeOnlyTextInParagraph:function(e){var t=new i(\"Raw tag should be the only text in paragraph\"),r=e.part.value;throw t.properties={id:\"raw_xml_tag_should_be_only_text_in_paragraph\",explanation:'The raw tag \"'.concat(r,'\" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:r,offset:e.part.offset,paragraphParts:e.paragraphParts},t},throwUnimplementedTagType:function(e,t){var r='Unimplemented tag type \"'.concat(e.type,'\"');e.module&&(r+=' \"'.concat(e.module,'\"'));var n=new i(r);throw n.properties={part:e,index:t,id:\"unimplemented_tag_type\"},n},throwXmlTagNotFound:function(e){var t=new i('No tag \"'.concat(e.element,'\" was found at the ').concat(e.position)),r=e.parsed[e.index];throw t.properties={id:\"no_xml_tag_found_at_\".concat(e.position),explanation:'No tag \"'.concat(e.element,'\" was found at the ').concat(e.position),offset:r.offset,part:r,parsed:e.parsed,index:e.index,element:e.element},t},throwXmlInvalid:function(e,t){var r=new i(\"An XML file has invalid xml\");throw r.properties={id:\"file_has_invalid_xml\",content:e,offset:t,explanation:\"The docx contains invalid XML, it is most likely corrupt\"},r},throwResolveBeforeCompile:function(){var e=new l(\"You must run `.compile()` before running `.resolveData()`\");throw e.properties={id:\"resolve_before_compile\",explanation:\"You must run `.compile()` before running `.resolveData()`\"},e},throwRenderInvalidTemplate:function(){var e=new l(\"You should not call .render on a document that had compilation errors\");throw e.properties={id:\"render_on_invalid_template\",explanation:\"You should not call .render on a document that had compilation errors\"},e},throwRenderTwice:function(){var e=new l(\"You should not call .render twice on the same docxtemplater instance\");throw e.properties={id:\"render_twice\",explanation:\"You should not call .render twice on the same docxtemplater instance\"},e}}},function(e,t,r){\"use strict\";function n(){}function o(e){return e}var a=r(1).XTInternalError;e.exports=function(e){var t={set:n,matchers:function(){return[]},parse:n,render:n,getTraits:n,getFileType:n,nullGetter:n,optionsTransformer:o,postrender:o,errorsTransformer:o,getRenderedMap:o,preparse:o,postparse:o,on:n,resolve:n};if(Object.keys(t).every(function(t){return!e[t]})){var r=new a(\"This module cannot be wrapped, because it doesn't define any of the necessary functions\");throw r.properties={id:\"module_cannot_be_wrapped\",explanation:\"This module cannot be wrapped, because it doesn't define any of the necessary functions\"},r}return Object.keys(t).forEach(function(r){e[r]=e[r]||t[r]}),e}},function(e,t){\"use strict\";function r(e,t){return void 0===t&&(t=Object),t&&\"function\"==typeof t.freeze?t.freeze(e):e}var n=r({HTML:\"text/html\",isHTML:function(e){return e===n.HTML},XML_APPLICATION:\"application/xml\",XML_TEXT:\"text/xml\",XML_XHTML_APPLICATION:\"application/xhtml+xml\",XML_SVG_IMAGE:\"image/svg+xml\"}),o=r({HTML:\"http://www.w3.org/1999/xhtml\",isHTML:function(e){return e===o.HTML},SVG:\"http://www.w3.org/2000/svg\",XML:\"http://www.w3.org/XML/1998/namespace\",XMLNS:\"http://www.w3.org/2000/xmlns/\"});t.assign=function(e,t){if(null===e||\"object\"!=typeof e)throw new TypeError(\"target is not an object\");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},t.freeze=r,t.MIME_TYPE=n,t.NAMESPACE=o},function(e){\"use strict\";e.exports={last:function(e){return e[e.length-1]},first:function(e){return e[0]}}},function(e,t,r){\"use strict\";function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(e,t)||a(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function a(e,t){if(e){if(\"string\"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===r&&e.constructor&&(r=e.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){return(l=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function c(e,t){return 0!==e.length&&0===T(e).substr(1).indexOf(t)}function p(e,t,r,n){var o=e.expandTo||n.expandTo;if(o){var a,i;try{i=g(r,o,t),a=m(r,o,t)}catch(a){throw a instanceof N&&P(function(e){for(var t,r=1;r<arguments.length;r++)t=null==arguments[r]?{}:arguments[r],r%2?s(Object(t),!0).forEach(function(r){u(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))});return e}({part:e,rootError:a,postparsed:r,expandTo:o,index:t},n.error)),a}return[i,a]}}function f(e,t,r,n){var a=o(e,2),i=a[0],s=a[1],u=r.indexOf(t),l=r.slice(i,u),c=r.slice(u+1,s+1),p=n.getInner({postparse:n.postparse,index:u,part:t,leftParts:l,rightParts:c,left:i,right:s,postparsed:r});return p.length||(p.expanded=[l,c],p=[p]),{left:i,right:s,inner:p}}var h=r(0),d=h.getRightOrNull,m=h.getRight,g=h.getLeft,v=h.getLeftOrNull,y=h.chunkBy,b=h.isTagStart,x=h.isTagEnd,w=h.isContent,T=h.last,E=h.first,O=r(1),N=O.XTTemplateError,P=O.throwExpandNotFound,S=O.getLoopPositionProducesInvalidXMLError;e.exports={expandToOne:function(e,t){var r=[];e.errors&&(r=e.errors,e=e.postparsed);for(var a,i=[],s=0,u=e.length;s<u;s++)if(\"placeholder\"===(a=e[s]).type&&a.module===t.moduleName)try{var l=p(a,s,e,t);if(!l)continue;var c=o(l,2),h=c[0],d=c[1];i.push({left:h,right:d,part:a,i:s,leftPart:e[h],rightPart:e[d]})}catch(e){if(!(e instanceof N))throw e;r.push(e)}i.sort(function(e,t){return e.left===t.left?t.part.lIndex<e.part.lIndex?1:-1:t.left<e.left?1:-1});var m=-1,g=0;return i.forEach(function(o,a){var s;if(m=Math.max(m,0<a?i[a-1].right:0),!(o.left<m)){var u;try{u=f([o.left+g,o.right+g],o.part,e,t)}catch(e){if(!(e instanceof N))throw e;r.push(e)}u&&(g+=u.inner.length-(u.right+1-u.left),(s=e).splice.apply(s,[u.left,u.right+1-u.left].concat(n(u.inner))))}}),{postparsed:e,errors:r}},getExpandToDefault:function(e,t,r){var n=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],o=n.position,a=n.value,i=n.tag;i&&(\"end\"===o?c(t,i)?t.pop():t.push(a):\"start\"===o&&t.push(a))}return t}(e.slice(t[0].offset,t[1].offset));if(n.filter(function(e){return\"/\"===e[1]}).length!==n.filter(function(e){return\"/\"!==e[1]&&\"/\"!==e[e.length-2]}).length)return{error:S({tag:E(t).part.value,offset:[E(t).part.offset,T(t).part.offset]})};for(var o,a=function(o){var a=r[o],i=a.contains,s=a.expand,u=a.onlyTextInTag;if(function(e,t){for(var r=0;r<t.length;r++)if(0===t[r].indexOf(\"<\".concat(e)))return!0;return!1}(i,n)){if(u){var l=v(e,i,t[0].offset),c=d(e,i,t[1].offset);if(null===l||null===c)return\"continue\";var p=y(e.slice(l,c),function(e){return b(i,e)?\"start\":x(i,e)?\"end\":null}),f=E(p),h=T(p),m=f.filter(w),g=h.filter(w);if(1!==m.length||1!==g.length)return\"continue\"}return{v:{value:s}}}},i=0,s=r.length;i<s;i++)if(\"continue\"!==(o=a(i))&&\"object\"===l(o))return o.v;return{}}}},function(e){\"use strict\";var t=[\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\",\"application/vnd.ms-word.document.macroEnabled.main+xml\",\"application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml\",\"application/vnd.ms-word.template.macroEnabledTemplate.main+xml\"],r={main:t,docx:[].concat(t,[\"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml\",\"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml\"]),pptx:[\"application/vnd.openxmlformats-officedocument.presentationml.slide+xml\",\"application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml\",\"application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml\",\"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml\"]};e.exports=r},function(e,t,r){function n(e){return\"\"!==e}function o(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function a(e){if(!e)return[];var t=function(e){return e?e.split(/[\\t\\n\\f\\r ]+/).filter(n):[]}(e);return Object.keys(t.reduce(o,{}))}function i(e,t){for(var r in e)t[r]=e[r]}function s(e,t){var r=e.prototype;if(!(r instanceof t)){function n(){}n.prototype=t.prototype,i(r,n=new n),e.prototype=r=n}r.constructor!=e&&(\"function\"!=typeof e&&console.error(\"unknown Class:\"+e),r.constructor=e)}function u(e,t){if(t instanceof Error)var r=t;else r=this,Error.call(this,oe[e]),this.message=oe[e],Error.captureStackTrace&&Error.captureStackTrace(this,u);return r.code=e,t&&(this.message=this.message+\": \"+t),r}function l(){}function c(e,t){this._node=e,this._refresh=t,p(this)}function p(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var r=e._refresh(e._node);z(e,\"length\",r.length),i(r,e),e._inc=t}}function f(){}function h(e,t){for(var r=e.length;r--;)if(e[r]===t)return r}function d(e,t,r,n){if(n?t[h(t,n)]=r:t[t.length++]=r,e){r.ownerElement=e;var o=e.ownerDocument;o&&(n&&w(o,e,n),function(e,t,r){e&&e._inc++,r.namespaceURI===B.XMLNS&&(t._nsMap[r.prefix?r.localName:\"\"]=r.value)}(o,e,r))}}function m(e,t,r){var n=h(t,r);if(!(0<=n))throw u(ie,new Error(e.tagName+\"@\"+r));for(var o=t.length-1;n<o;)t[n]=t[++n];if(t.length=o,e){var a=e.ownerDocument;a&&(w(a,e,r),r.ownerElement=null)}}function g(){}function v(){}function y(e){return(\"<\"==e?\"&lt;\":\">\"==e&&\"&gt;\")||\"&\"==e&&\"&amp;\"||'\"'==e&&\"&quot;\"||\"&#\"+e.charCodeAt()+\";\"}function b(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(b(e,t))return!0}while(e=e.nextSibling)}function x(){}function w(e,t,r){e&&e._inc++,r.namespaceURI===B.XMLNS&&delete t._nsMap[r.prefix?r.localName:\"\"]}function T(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r)n[n.length++]=r;else{for(var o=t.firstChild,a=0;o;)n[a++]=o,o=o.nextSibling;n.length=a,delete n[n.length]}}}function E(e,t){var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,T(e.ownerDocument,e),t}function O(e,t,r){var n=t.parentNode;if(n&&n.removeChild(t),t.nodeType===te){var o=t.firstChild;if(null==o)return t;var a=t.lastChild}else o=a=t;var i=r?r.previousSibling:e.lastChild;o.previousSibling=i,a.nextSibling=r,i?i.nextSibling=o:e.firstChild=o,null==r?e.lastChild=a:r.previousSibling=a;do{o.parentNode=e}while(o!==a&&(o=o.nextSibling));return T(e.ownerDocument||e,e),t.nodeType==te&&(t.firstChild=t.lastChild=null),t}function N(){this._nsMap={}}function P(){}function S(){}function I(){}function A(){}function C(){}function M(){}function D(){}function k(){}function _(){}function j(){}function L(){}function R(){}function F(e,t){var r=[],n=9==this.nodeType&&this.documentElement||this,o=n.prefix,a=n.namespaceURI;if(a&&null==o&&null==(o=n.lookupPrefix(a)))var i=[{namespace:a,prefix:null}];return V(this,r,e,t,i),r.join(\"\")}function U(e,t,r){var n=e.prefix||\"\",o=e.namespaceURI;if(!o)return!1;if(\"xml\"===n&&o===B.XML||o===B.XMLNS)return!1;for(var a=r.length;a--;){var i=r[a];if(i.prefix===n)return i.namespace!==o}return!0}function X(e,t,r){e.push(\" \",t,'=\"',r.replace(/[<>&\"\\t\\n\\r]/g,y),'\"')}function V(e,t,r,n,o){if(o||(o=[]),n){if(!(e=n(e)))return;if(\"string\"==typeof e)return void t.push(e)}switch(e.nodeType){case q:var a=e.attributes,i=a.length,s=e.firstChild,u=e.tagName,l=u;if(!(r=B.isHTML(e.namespaceURI)||r)&&!e.prefix&&e.namespaceURI){for(var c,p=0;p<a.length;p++)if(\"xmlns\"===a.item(p).name){c=a.item(p).value;break}if(!c)for(var f=o.length-1;0<=f;f--)if(\"\"===(h=o[f]).prefix&&h.namespace===e.namespaceURI){c=h.namespace;break}if(c!==e.namespaceURI){var h;for(f=o.length-1;0<=f;f--)if((h=o[f]).namespace===e.namespaceURI){h.prefix&&(l=h.prefix+\":\"+u);break}}}t.push(\"<\",l);for(var d=0;d<i;d++)\"xmlns\"==(m=a.item(d)).prefix?o.push({prefix:m.localName,namespace:m.value}):\"xmlns\"==m.nodeName&&o.push({prefix:\"\",namespace:m.value});var m;for(d=0;d<i;d++){var g,v;if(U(m=a.item(d),0,o))X(t,(g=m.prefix||\"\")?\"xmlns:\"+g:\"xmlns\",v=m.namespaceURI),o.push({prefix:g,namespace:v});V(m,t,r,n,o)}if(u===l&&U(e,0,o))X(t,(g=e.prefix||\"\")?\"xmlns:\"+g:\"xmlns\",v=e.namespaceURI),o.push({prefix:g,namespace:v});if(s||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(t.push(\">\"),r&&/^script$/i.test(u))for(;s;)s.data?t.push(s.data):V(s,t,r,n,o.slice()),s=s.nextSibling;else for(;s;)V(s,t,r,n,o.slice()),s=s.nextSibling;t.push(\"</\",l,\">\")}else t.push(\"/>\");return;case K:case te:for(s=e.firstChild;s;)V(s,t,r,n,o.slice()),s=s.nextSibling;return;case $:return X(t,e.name,e.value);case G:return t.push(e.data.replace(/[<&>]/g,y));case W:return t.push(\"<![CDATA[\",e.data,\"]]>\");case J:return t.push(\"\\x3c!--\",e.data,\"--\\x3e\");case ee:var b=e.publicId,x=e.systemId;if(t.push(\"<!DOCTYPE \",e.name),b)t.push(\" PUBLIC \",b),x&&\".\"!=x&&t.push(\" \",x),t.push(\">\");else if(x&&\".\"!=x)t.push(\" SYSTEM \",x,\">\");else{var w=e.internalSubset;w&&t.push(\" [\",w,\"]\"),t.push(\">\")}return;case Q:return t.push(\"<?\",e.target,\" \",e.data,\"?>\");case Y:return t.push(\"&\",e.nodeName,\";\");default:t.push(\"??\",e.nodeName)}}function z(e,t,r){e[t]=r}var B=r(3).NAMESPACE,H={},q=H.ELEMENT_NODE=1,$=H.ATTRIBUTE_NODE=2,G=H.TEXT_NODE=3,W=H.CDATA_SECTION_NODE=4,Y=H.ENTITY_REFERENCE_NODE=5,Z=H.ENTITY_NODE=6,Q=H.PROCESSING_INSTRUCTION_NODE=7,J=H.COMMENT_NODE=8,K=H.DOCUMENT_NODE=9,ee=H.DOCUMENT_TYPE_NODE=10,te=H.DOCUMENT_FRAGMENT_NODE=11,re=H.NOTATION_NODE=12,ne={},oe={},ae=(ne.INDEX_SIZE_ERR=(oe[1]=\"Index size error\",1),ne.DOMSTRING_SIZE_ERR=(oe[2]=\"DOMString size error\",2),ne.HIERARCHY_REQUEST_ERR=(oe[3]=\"Hierarchy request error\",3)),ie=(ne.WRONG_DOCUMENT_ERR=(oe[4]=\"Wrong document\",4),ne.INVALID_CHARACTER_ERR=(oe[5]=\"Invalid character\",5),ne.NO_DATA_ALLOWED_ERR=(oe[6]=\"No data allowed\",6),ne.NO_MODIFICATION_ALLOWED_ERR=(oe[7]=\"No modification allowed\",7),ne.NOT_FOUND_ERR=(oe[8]=\"Not found\",8)),se=(ne.NOT_SUPPORTED_ERR=(oe[9]=\"Not supported\",9),ne.INUSE_ATTRIBUTE_ERR=(oe[10]=\"Attribute in use\",10));ne.INVALID_STATE_ERR=(oe[11]=\"Invalid state\",11),ne.SYNTAX_ERR=(oe[12]=\"Syntax error\",12),ne.INVALID_MODIFICATION_ERR=(oe[13]=\"Invalid modification\",13),ne.NAMESPACE_ERR=(oe[14]=\"Invalid namespace\",14),ne.INVALID_ACCESS_ERR=(oe[15]=\"Invalid access\",15);u.prototype=Error.prototype,i(ne,u),l.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var r=[],n=0;n<this.length;n++)V(this[n],r,e,t);return r.join(\"\")}},c.prototype.item=function(e){return p(this),this[e]},s(c,l),f.prototype={length:0,item:l.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var r=this[t];if(r.nodeName==e)return r}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new u(se);var r=this.getNamedItem(e.nodeName);return d(this._ownerElement,this,e,r),r},setNamedItemNS:function(e){var t,r=e.ownerElement;if(r&&r!=this._ownerElement)throw new u(se);return t=this.getNamedItemNS(e.namespaceURI,e.localName),d(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return m(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);return m(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){for(var r=this.length;r--;){var n=this[r];if(n.localName==t&&n.namespaceURI==e)return n}return null}},g.prototype={hasFeature:function(){return!0},createDocument:function(e,t,r){var n=new x;if(n.implementation=this,n.childNodes=new l,n.doctype=r||null,r&&n.appendChild(r),t){var o=n.createElementNS(e,t);n.appendChild(o)}return n},createDocumentType:function(e,t,r){var n=new M;return n.name=e,n.nodeName=e,n.publicId=t||\"\",n.systemId=r||\"\",n}},v.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return O(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return E(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,r,n){var o=new r.constructor;for(var a in r){var i=r[a];\"object\"!=typeof i&&i!=o[a]&&(o[a]=i)}switch(r.childNodes&&(o.childNodes=new l),o.ownerDocument=t,o.nodeType){case q:var s=r.attributes,u=o.attributes=new f,c=s.length;u._ownerElement=o;for(var p=0;p<c;p++)o.setAttributeNode(e(t,s.item(p),!0));break;case $:n=!0}if(n)for(var h=r.firstChild;h;)o.appendChild(e(t,h,n)),h=h.nextSibling;return o}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==G&&e.nodeType==G?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r)for(var n in r)if(r[n]==e)return n;t=t.nodeType==$?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&e in r)return r[e];t=t.nodeType==$?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},i(H,v),i(H,v.prototype),x.prototype={nodeName:\"#document\",nodeType:K,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==te){for(var r,n=e.firstChild;n;)r=n.nextSibling,this.insertBefore(n,t),n=r;return e}return null==this.documentElement&&e.nodeType==q&&(this.documentElement=e),O(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),E(this,e)},importNode:function(e,t){return function e(t,r,n){var o;switch(r.nodeType){case q:(o=r.cloneNode(!1)).ownerDocument=t;case te:break;case $:n=!0}if(o||(o=r.cloneNode(!1)),o.ownerDocument=t,o.parentNode=null,n)for(var a=r.firstChild;a;)o.appendChild(e(t,a,n)),a=a.nextSibling;return o}(this,e,t)},getElementById:function(e){var t=null;return b(this.documentElement,function(r){if(r.nodeType==q&&r.getAttribute(\"id\")==e)return t=r,!0}),t},getElementsByClassName:function(e){var t=a(e);return new c(this,function(r){var n=[];return 0<t.length&&b(r.documentElement,function(o){if(o!==r&&o.nodeType===q){var i=o.getAttribute(\"class\");if(i){var s=e===i;if(!s){var u=a(i);s=t.every(function(e){return function(t){return e&&-1!==e.indexOf(t)}}(u))}s&&n.push(o)}}}),n})},createElement:function(e){var t=new N;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new l,(t.attributes=new f)._ownerElement=t,t},createDocumentFragment:function(){var e=new j;return e.ownerDocument=this,e.childNodes=new l,e},createTextNode:function(e){var t=new I;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new A;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new C;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new L;return r.ownerDocument=this,r.tagName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){var t=new P;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new _;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var r=new N,n=t.split(\":\"),o=r.attributes=new f;return r.childNodes=new l,r.ownerDocument=this,r.nodeName=t,r.tagName=t,r.namespaceURI=e,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,o._ownerElement=r,r},createAttributeNS:function(e,t){var r=new P,n=t.split(\":\");return r.ownerDocument=this,r.nodeName=t,r.name=t,r.namespaceURI=e,r.specified=!0,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,r}},s(x,v),N.prototype={nodeType:q,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||\"\"},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var r=this.ownerDocument.createAttribute(e);r.value=r.nodeValue=\"\"+t,this.setAttributeNode(r)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===te?this.insertBefore(e,null):function(e,t){return t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,t.previousSibling=e.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,e.lastChild=t,T(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r&&r.value||\"\"},setAttributeNS:function(e,t,r){var n=this.ownerDocument.createAttributeNS(e,t);n.value=n.nodeValue=\"\"+r,this.setAttributeNode(n)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new c(this,function(t){var r=[];return b(t,function(n){n!==t&&n.nodeType==q&&(\"*\"===e||n.tagName==e)&&r.push(n)}),r})},getElementsByTagNameNS:function(e,t){return new c(this,function(r){var n=[];return b(r,function(o){o!==r&&o.nodeType===q&&(\"*\"===e||o.namespaceURI===e)&&(\"*\"===t||o.localName==t)&&n.push(o)}),n})}},x.prototype.getElementsByTagName=N.prototype.getElementsByTagName,x.prototype.getElementsByTagNameNS=N.prototype.getElementsByTagNameNS,s(N,v),P.prototype.nodeType=$,s(P,v),S.prototype={data:\"\",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(){throw new Error(oe[ae])},deleteData:function(e,t){this.replaceData(e,t,\"\")},replaceData:function(e,t,r){r=this.data.substring(0,e)+r+this.data.substring(e+t),this.nodeValue=this.data=r,this.length=r.length}},s(S,v),I.prototype={nodeName:\"#text\",nodeType:G,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},s(I,S),A.prototype={nodeName:\"#comment\",nodeType:J},s(A,S),C.prototype={nodeName:\"#cdata-section\",nodeType:W},s(C,S),M.prototype.nodeType=ee,s(M,v),D.prototype.nodeType=re,s(D,v),k.prototype.nodeType=Z,s(k,v),_.prototype.nodeType=Y,s(_,v),j.prototype.nodeName=\"#document-fragment\",j.prototype.nodeType=te,s(j,v),L.prototype.nodeType=Q,s(L,v),R.prototype.serializeToString=function(e,t,r){return F.call(e,t,r)},v.prototype.toString=F;try{if(Object.defineProperty){Object.defineProperty(c.prototype,\"length\",{get:function(){return p(this),this.$$length}}),Object.defineProperty(v.prototype,\"textContent\",{get:function(){return function e(t){switch(t.nodeType){case q:case te:var r=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&r.push(e(t)),t=t.nextSibling;return r.join(\"\");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case q:case te:for(;this.firstChild;)this.removeChild(this.firstChild);(e||e+\"\")&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),z=function(e,t,r){e[\"$$\"+t]=r}}}catch(t){}t.DocumentType=M,t.DOMException=u,t.DOMImplementation=g,t.Element=N,t.Node=v,t.NodeList=l,t.XMLSerializer=R},function(e,t,r){\"use strict\";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(e){if(\"string\"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===r&&e.constructor&&(r=e.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){return e[0]<=t.offset&&t.offset<e[1]}function i(e){var t=\"\",r=1,n=e.indexOf(\" \");return\"/\"===e[e.length-2]?(t=\"selfclosing\",-1===n&&(n=e.length-2)):\"/\"===e[1]?(r=2,t=\"end\",-1===n&&(n=e.length-1)):(t=\"start\",-1===n&&(n=e.length-1)),{tag:e.slice(r,n),position:t}}function s(e,t){return-1===e&&-1===t?N:e===t?P:-1===e||-1===t?t<e?S:I:e<t?S:I}function u(e){var t=e.split(\" \");if(2!==t.length)throw(r=new x(\"New Delimiters cannot be parsed\")).properties={id:\"change_delimiters_invalid\",explanation:\"Cannot parser delimiters\"},r;var r,o=n(t,2),a=o[0],i=o[1];if(0===a.length||0===i.length)throw(r=new x(\"New Delimiters cannot be parsed\")).properties={id:\"change_delimiters_invalid\",explanation:\"Cannot parser delimiters\"},r;return[a,i]}function l(e,t){for(var r=[],o=t.start,a=t.end,i=-1,l=!1;;){var c=e.indexOf(o,i+1),p=e.indexOf(a,i+1),f=null,h=void 0,d=s(c,p);switch(d===P&&(d=l?I:S),d){case N:return r;case I:l=!1,i=p,f=\"end\",h=a.length;break;case S:l=!0,i=c,f=\"start\",h=o.length}if(d!==S||\"=\"!==e[i+o.length])r.push({offset:i,position:f,length:h});else{r.push({offset:c,position:\"start\",length:o.length,changedelimiter:!0});var m=e.indexOf(\"=\",i+o.length+1),g=e.indexOf(a,m+1);r.push({offset:g,position:\"end\",length:a.length,changedelimiter:!0});var v=n(u(e.substr(i+o.length+1,m-i-o.length-1)),2);o=v[0],a=v[1],i=g}}}function c(e,t){var r=e.map(function(e){return e.value}).join(\"\"),n=l(r,t),o=0,i=e.map(function(e){return{offset:(o+=e.value.length)-e.value.length,lIndex:e.lIndex}}),s=function(e,t){var r,n=[],o=!1,a={offset:0};e.forEach(function(e){r=t.substr(a.offset,e.offset-a.offset),\"start\"===e.position&&o||\"end\"===e.position&&!o?\"start\"===e.position?(a.offset+a.length===e.offset?(r=t.substr(a.offset,e.offset-a.offset+a.length+4),n.push(g({xtag:r,offset:a.offset}))):n.push(d({xtag:O(r),offset:a.offset})),e.error=!0):(a.offset+a.length===e.offset?(r=t.substr(a.offset-4,e.offset-a.offset+4+a.length),n.push(v({xtag:r,offset:a.offset}))):n.push(m({xtag:r,offset:e.offset})),e.error=!0):o=!o,a=e});var i={offset:t.length};return r=t.substr(a.offset,i.offset-a.offset),o&&(n.push(d({xtag:O(r),offset:a.offset})),i.error=!0),n}(n,r),u=0,c=0;return{parsed:i.map(function(t,r){for(var o=t.offset,i=[o,o+e[r].value.length],s=e[r].value,l=[];c<n.length&&a(i,n[c]);)l.push(n[c]),c++;var p=[],f=0;0<u&&(f=u,u=0),l.forEach(function(e){var t=s.substr(f,e.offset-o-f);if(e.changedelimiter)\"start\"===e.position?0<t.length&&p.push({type:\"content\",value:t}):f=e.offset-o+e.length;else{0<t.length&&(p.push({type:\"content\",value:t}),f+=t.length);var r={type:\"delimiter\",position:e.position,offset:f+o};p.push(r),f=e.offset-o+e.length}}),u=f-s.length;var h=s.substr(f);return 0<h.length&&p.push({type:\"content\",value:h}),p},this),errors:s}}function p(e){return\"content\"===e.type&&\"insidetag\"===e.position}function f(e){var t=!1;e.forEach(function(e){t=function(e,t){return T(e)?(t&&y(),!0):E(e)?(t||y(),!1):t}(e,t),\"content\"===e.type&&(e.position=t?\"insidetag\":\"outsidetag\"),p(e)&&(e.value=e.value.replace(/>/g,\"&gt;\"))})}var h=r(1),d=h.getUnclosedTagException,m=h.getUnopenedTagException,g=h.getDuplicateOpenTagException,v=h.getDuplicateCloseTagException,y=h.throwMalformedXml,b=h.throwXmlInvalid,x=h.XTTemplateError,w=r(0),T=w.isTextStart,E=w.isTextEnd,O=w.wordToUtf8,N=0,P=1,S=2,I=3;e.exports={parseDelimiters:c,parse:function(e,t){f(e);var r=c(function(e){return e.filter(p)}(e),t),n=r.parsed,o=r.errors,a=[],i=0,s=0;return e.forEach(function(e){p(e)?(Array.prototype.push.apply(a,n[i].map(function(e){return\"content\"===e.type&&(e.position=\"insidetag\"),e.lIndex=s++,e})),i++):(e.lIndex=s++,a.push(e))}),{errors:o,lexed:a}},xmlparse:function(e,t){var r=function(e,t,r){for(var n=0,o=e.length,a={},s=0,u=t.length;s<u;s++)a[t[s]]=!0;for(var l=0,c=r.length;l<c;l++)a[r[l]]=!1;for(var p=[];n<o&&-1!==(n=e.indexOf(\"<\",n));){var f=n,h=e.indexOf(\"<\",n+1);(-1===(n=e.indexOf(\">\",n))||-1!==h&&n>h)&&b(e,f);var d=e.slice(f,n+1),m=i(d),g=m.tag,v=m.position,y=a[g];null==y||p.push({type:\"tag\",position:v,text:y,offset:f,value:d,tag:g})}return p}(e,t.text,t.other),n=0,o=r.reduce(function(t,r){var o=e.substr(n,r.offset-n);return 0<o.length&&t.push({type:\"content\",value:o}),n=r.offset+r.value.length,delete r.offset,t.push(r),t},[]),a=e.substr(n);return 0<a.length&&o.push({type:\"content\",value:a}),o}}},function(e,t,r){\"use strict\";var n=r(0).pregMatchAll;e.exports=function(e,t){var r={content:e},o=t.join(\"|\"),a=new RegExp(\"(?:(<(?:\".concat(o,\")[^>]*>)([^<>]*)</(?:\").concat(o,\")>)|(<(?:\").concat(o,\")[^>]*/>)\"),\"g\");return r.matches=n(a,r.content),r}},function(e,t,r){\"use strict\";function n(e){return(n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function o(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],0<=t.indexOf(r)||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(0<=t.indexOf(r))&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function a(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function i(e){var t=e.compiled;e.errors=E(Object.keys(t).map(function(e){return t[e].allErrors})),0!==e.errors.length&&(e.options.errorLogging&&m(e.errors,e.options.errorLogging),p(e.errors))}var s=[\"modules\"],u=r(0);u.traits=r(5),u.moduleWrapper=r(2);var l=r(16),c=r(1),p=c.throwMultiError,f=c.throwResolveBeforeCompile,h=c.throwRenderInvalidTemplate,d=c.throwRenderTwice,m=r(17),g=r(18),v=r(19),y=r(8),b=u.defaults,x=u.str2xml,w=u.xml2str,T=u.moduleWrapper,E=u.concatArrays,O=u.uniq,N=r(1),P=N.XTInternalError,S=N.throwFileTypeNotIdentified,I=N.throwFileTypeNotHandled,A=N.throwApiVersionError,C=[3,33,0],M=function(){function e(t){var r=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=n.modules,i=void 0===a?[]:a,u=o(n,s);if(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),!Array.isArray(i))throw new Error(\"The modules argument of docxtemplater's constructor must be an array\");if(this.rendered=!1,this.scopeManagers={},this.compiled={},this.modules=[v()],this.setOptions(u),i.forEach(function(e){r.attachModule(e)}),0<arguments.length){if(!t||!t.files||\"function\"!=typeof t.file)throw new Error(\"The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)\");this.loadZip(t),this.modules=this.modules.filter(function(e){if(e.supportedFileTypes){if(!Array.isArray(e.supportedFileTypes))throw new Error(\"The supportedFileTypes field of the module must be an array\");var t=-1!==e.supportedFileTypes.indexOf(r.fileType);return t||e.on(\"detached\"),t}return!0}),this.compile(),this.v4Constructor=!0}}return function(e,t,r){t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,\"prototype\",{writable:!1})}(e,[{key:\"verifyApiVersion\",value:function(e){return 3!==(e=e.split(\".\").map(function(e){return parseInt(e,10)})).length&&A(\"neededVersion is not a valid version\",{neededVersion:e,explanation:\"the neededVersion must be an array of length 3\"}),e[0]!==C[0]&&A(\"The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater\",{neededVersion:e,currentModuleApiVersion:C,explanation:\"moduleAPIVersionMismatch : needed=\".concat(e.join(\".\"),\", current=\").concat(C.join(\".\"))}),e[1]>C[1]&&A(\"The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater\",{neededVersion:e,currentModuleApiVersion:C,explanation:\"moduleAPIVersionMismatch : needed=\".concat(e.join(\".\"),\", current=\").concat(C.join(\".\"))}),e[1]===C[1]&&e[2]>C[2]&&A(\"The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater\",{neededVersion:e,currentModuleApiVersion:C,explanation:\"moduleAPIVersionMismatch : needed=\".concat(e.join(\".\"),\", current=\").concat(C.join(\".\"))}),!0}},{key:\"setModules\",value:function(e){this.modules.forEach(function(t){t.set(e)})}},{key:\"sendEvent\",value:function(e){this.modules.forEach(function(t){t.on(e)})}},{key:\"attachModule\",value:function(e){if(this.v4Constructor)throw new P(\"attachModule() should not be called manually when using the v4 constructor\");var t=n(e);if(\"function\"===t)throw new P(\"Cannot attach a class/function as a module. Most probably you forgot to instantiate the module by using `new` on the module.\");if(!e||\"object\"!==t)throw new P(\"Cannot attachModule with a falsy value\");if(e.requiredAPIVersion&&this.verifyApiVersion(e.requiredAPIVersion),!0===e.attached){if(\"function\"!=typeof e.clone)throw new Error('Cannot attach a module that was already attached : \"'.concat(e.name,'\". The most likely cause is that you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'));e=e.clone()}e.attached=!0;var r=T(e);return this.modules.push(r),r.on(\"attached\"),this}},{key:\"setOptions\",value:function(e){var t=this;if(this.v4Constructor)throw new Error(\"setOptions() should not be called manually when using the v4 constructor\");if(!e)throw new Error(\"setOptions should be called with an object as first parameter\");return this.options={},Object.keys(b).forEach(function(r){var n=b[r];t.options[r]=null==e[r]?n:e[r],t[r]=t.options[r]}),this.delimiters.start=u.utf8ToWord(this.delimiters.start),this.delimiters.end=u.utf8ToWord(this.delimiters.end),this.zip&&this.updateFileTypeConfig(),this}},{key:\"loadZip\",value:function(e){if(this.v4Constructor)throw new Error(\"loadZip() should not be called manually when using the v4 constructor\");if(e.loadAsync)throw new P(\"Docxtemplater doesn't handle JSZip version >=3, please use pizzip\");return this.zip=e,this.updateFileTypeConfig(),this.modules=E([this.fileTypeConfig.baseModules.map(function(e){return e()}),this.modules]),this}},{key:\"precompileFile\",value:function(e){var t=this.createTemplateClass(e);t.preparse(),this.compiled[e]=t}},{key:\"compileFile\",value:function(e){this.compiled[e].parse()}},{key:\"getScopeManager\",value:function(e,t,r){return this.scopeManagers[e]||(this.scopeManagers[e]=l({tags:r||{},parser:this.parser,cachedParsers:t.cachedParsers})),this.scopeManagers[e]}},{key:\"resolveData\",value:function(e){var t=this,r=[];return Object.keys(this.compiled).length||f(),Promise.resolve(e).then(function(e){return t.setData(e),t.setModules({data:t.data,Lexer:y}),t.mapper=t.modules.reduce(function(e,t){return t.getRenderedMap(e)},{}),Promise.all(Object.keys(t.mapper).map(function(e){var n=t.mapper[e],o=n.from,a=n.data;return Promise.resolve(a).then(function(n){var a=t.compiled[o];return a.filePath=e,a.scopeManager=t.getScopeManager(e,a,n),a.resolveTags(n).then(function(e){return a.scopeManager.finishedResolving=!0,e},function(e){Array.prototype.push.apply(r,e)})})})).then(function(e){return 0!==r.length&&(t.options.errorLogging&&m(r,t.options.errorLogging),p(r)),E(e)})})}},{key:\"compile\",value:function(){var e=this;return Object.keys(this.compiled).length?this:(this.options=this.modules.reduce(function(t,r){return r.optionsTransformer(t,e)},this.options),this.options.xmlFileNames=O(this.options.xmlFileNames),this.xmlDocuments=this.options.xmlFileNames.reduce(function(t,r){var n=e.zip.files[r].asText();return t[r]=x(n),t},{}),this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments}),this.getTemplatedFiles(),this.templatedFiles.forEach(function(t){null!=e.zip.files[t]&&e.precompileFile(t)}),this.templatedFiles.forEach(function(t){null!=e.zip.files[t]&&e.compileFile(t)}),this.setModules({compiled:this.compiled}),i(this),this)}},{key:\"updateFileTypeConfig\",value:function(){var t,r=this;this.zip.files.mimetype&&(t=\"odt\");var n=this.zip.files[\"[Content_Types].xml\"];this.targets=[];var o=n?x(n.asText()):null,a=o?o.getElementsByTagName(\"Override\"):null,i=o?o.getElementsByTagName(\"Default\"):null;return o&&(this.filesContentTypes=g(a,i,this.zip),this.invertedContentTypes=u.invertMap(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes})),this.modules.forEach(function(e){t=e.getFileType({zip:r.zip,contentTypes:n,contentTypeXml:o,overrides:a,defaults:i,doc:r})||t}),\"odt\"===t&&I(t),t||S(),this.fileType=t,this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig||e.FileTypeConfig[this.fileType](),this}},{key:\"renderAsync\",value:function(e){var t=this;return this.resolveData(e).then(function(){return t.render()})}},{key:\"render\",value:function(e){var t=this;return this.rendered&&d(),this.rendered=!0,this.compile(),0<this.errors.length&&h(),e&&this.setData(e),this.setModules({data:this.data,Lexer:y}),this.mapper=this.mapper||this.modules.reduce(function(e,t){return t.getRenderedMap(e)},{}),Object.keys(this.mapper).forEach(function(e){var r=t.mapper[e],n=r.from,o=r.data,a=t.compiled[n];a.scopeManager=t.getScopeManager(e,a,o),a.render(e),t.zip.file(e,a.content,{createFolders:!0})}),i(this),this.sendEvent(\"syncing-zip\"),this.syncZip(),this}},{key:\"syncZip\",value:function(){var e=this;Object.keys(this.xmlDocuments).forEach(function(t){e.zip.remove(t);var r=w(e.xmlDocuments[t]);return e.zip.file(t,r,{createFolders:!0})})}},{key:\"setData\",value:function(e){return this.data=e,this}},{key:\"getZip\",value:function(){return this.zip}},{key:\"createTemplateClass\",value:function(e){var t=this.zip.files[e].asText();return this.createTemplateClassFromContent(t,e)}},{key:\"createTemplateClassFromContent\",value:function(t,r){var n=this,o={filePath:r,contentType:this.filesContentTypes[r]};return Object.keys(b).concat([\"filesContentTypes\",\"fileTypeConfig\",\"fileType\",\"modules\"]).forEach(function(e){o[e]=n[e]}),new e.XmlTemplater(t,o)}},{key:\"getFullText\",value:function(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath(this)).getFullText()}},{key:\"getTemplatedFiles\",value:function(){var e=this;return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),this.targets.forEach(function(t){e.templatedFiles.push(t)}),this.templatedFiles=O(this.templatedFiles),this.templatedFiles}}]),e}();M.DocUtils=u,M.Errors=r(1),M.XmlTemplater=r(20),M.FileTypeConfig=r(27),M.XmlMatcher=r(9),e.exports=M},function(e,t,r){\"use strict\";r.r(t);var n=r(10),o=r.n(n);console.log(o.a)},function(e,t,r){var n=r(7);t.DOMImplementation=n.DOMImplementation,t.XMLSerializer=n.XMLSerializer,t.DOMParser=r(13).DOMParser},function(e,t,r){function n(e){return e.replace(/\\r[\\n\\u0085]/g,\"\\n\").replace(/[\\r\\u0085\\u2028]/g,\"\\n\")}function o(e){this.options=e||{locator:{}}}function a(e,t,r){function n(t){var n=e[t];!n&&a&&(n=2==e.length?function(r){e(t,r)}:e),o[t]=n&&function(e){n(\"[xmldom \"+t+\"]\\t\"+e+u(r))}||function(){}}if(!e){if(t instanceof i)return t;e=t}var o={},a=e instanceof Function;return r=r||{},n(\"warning\"),n(\"error\"),n(\"fatalError\"),o}function i(){this.cdata=!1}function s(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function u(e){if(e)return\"\\n@\"+(e.systemId||\"\")+\"#[line:\"+e.lineNumber+\",col:\"+e.columnNumber+\"]\"}function l(e,t,r){return\"string\"==typeof e?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+\"\":e}function c(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}var p=r(3),f=r(7),h=r(14),d=r(15),m=f.DOMImplementation,g=p.NAMESPACE,v=d.ParseError,y=d.XMLReader;o.prototype.parseFromString=function(e,t){var r=this.options,o=new y,s=r.domBuilder||new i,u=r.errorHandler,l=r.locator,c=r.xmlns||{},p=/\\/x?html?$/.test(t),f=p?h.HTML_ENTITIES:h.XML_ENTITIES;l&&s.setDocumentLocator(l),o.errorHandler=a(u,s,l),o.domBuilder=r.domBuilder||s,p&&(c[\"\"]=g.HTML),c.xml=c.xml||g.XML;var d=r.normalizeLineEndings||n;return e&&\"string\"==typeof e?o.parse(d(e),c,f):o.errorHandler.error(\"invalid doc source\"),s.doc},i.prototype={startDocument:function(){this.doc=(new m).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,r,n){var o=this.doc,a=o.createElementNS(e,r||t),i=n.length;c(this,a),this.currentElement=a,this.locator&&s(this.locator,a);for(var u=0;u<i;u++){e=n.getURI(u);var l=n.getValue(u),p=(r=n.getQName(u),o.createAttributeNS(e,r));this.locator&&s(n.getLocator(u),p),p.value=p.nodeValue=l,a.setAttributeNode(p)}},endElement:function(){var e=this.currentElement;e.tagName;this.currentElement=e.parentNode},startPrefixMapping:function(){},endPrefixMapping:function(){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&s(this.locator,r),c(this,r)},ignorableWhitespace:function(){},characters:function(e){if(e=l.apply(this,arguments)){if(this.cdata)var t=this.doc.createCDATASection(e);else t=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(t):/^\\s*$/.test(e)&&this.doc.appendChild(t),this.locator&&s(this.locator,t)}},skippedEntity:function(){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e){e=l.apply(this,arguments);var t=this.doc.createComment(e);this.locator&&s(this.locator,t),c(this,t)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r){var n=this.doc.implementation;if(n&&n.createDocumentType){var o=n.createDocumentType(e,t,r);this.locator&&s(this.locator,o),c(this,o),this.doc.doctype=o}},warning:function(e){console.warn(\"[xmldom warning]\\t\"+e,u(this.locator))},error:function(e){console.error(\"[xmldom error]\\t\"+e,u(this.locator))},fatalError:function(e){throw new v(e,this.locator)}},\"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl\".replace(/\\w+/g,function(e){i.prototype[e]=function(){return null}}),t.__DOMHandler=i,t.normalizeLineEndings=n,t.DOMParser=o},function(e,t,r){var n=r(3).freeze;t.XML_ENTITIES=n({amp:\"&\",apos:\"'\",gt:\">\",lt:\"<\",quot:'\"'}),t.HTML_ENTITIES=n({lt:\"<\",gt:\">\",amp:\"&\",quot:'\"',apos:\"'\",Agrave:\"Ã\",Aacute:\"Ã\",Acirc:\"Ã\",Atilde:\"Ã\",Auml:\"Ã\",Aring:\"Ã\",AElig:\"Ã\",Ccedil:\"Ã\",Egrave:\"Ã\",Eacute:\"Ã\",Ecirc:\"Ã\",Euml:\"Ã\",Igrave:\"Ã\",Iacute:\"Ã\",Icirc:\"Ã\",Iuml:\"Ã\",ETH:\"Ã\",Ntilde:\"Ã\",Ograve:\"Ã\",Oacute:\"Ã\",Ocirc:\"Ã\",Otilde:\"Ã\",Ouml:\"Ã\",Oslash:\"Ã\",Ugrave:\"Ã\",Uacute:\"Ã\",Ucirc:\"Ã\",Uuml:\"Ã\",Yacute:\"Ã\",THORN:\"Ã\",szlig:\"Ã\",agrave:\"Ã \",aacute:\"Ã¡\",acirc:\"Ã¢\",atilde:\"Ã£\",auml:\"Ã¤\",aring:\"Ã¥\",aelig:\"Ã¦\",ccedil:\"Ã§\",egrave:\"Ã¨\",eacute:\"Ã©\",ecirc:\"Ãª\",euml:\"Ã«\",igrave:\"Ã¬\",iacute:\"Ã­\",icirc:\"Ã®\",iuml:\"Ã¯\",eth:\"Ã°\",ntilde:\"Ã±\",ograve:\"Ã²\",oacute:\"Ã³\",ocirc:\"Ã´\",otilde:\"Ãµ\",ouml:\"Ã¶\",oslash:\"Ã¸\",ugrave:\"Ã¹\",uacute:\"Ãº\",ucirc:\"Ã»\",uuml:\"Ã¼\",yacute:\"Ã½\",thorn:\"Ã¾\",yuml:\"Ã¿\",nbsp:\"Â \",iexcl:\"Â¡\",cent:\"Â¢\",pound:\"Â£\",curren:\"Â¤\",yen:\"Â¥\",brvbar:\"Â¦\",sect:\"Â§\",uml:\"Â¨\",copy:\"Â©\",ordf:\"Âª\",laquo:\"Â«\",not:\"Â¬\",shy:\"Â­Â­\",reg:\"Â®\",macr:\"Â¯\",deg:\"Â°\",plusmn:\"Â±\",sup2:\"Â²\",sup3:\"Â³\",acute:\"Â´\",micro:\"Âµ\",para:\"Â¶\",middot:\"Â·\",cedil:\"Â¸\",sup1:\"Â¹\",ordm:\"Âº\",raquo:\"Â»\",frac14:\"Â¼\",frac12:\"Â½\",frac34:\"Â¾\",iquest:\"Â¿\",times:\"Ã\",divide:\"Ã·\",forall:\"â\",part:\"â\",exist:\"â\",empty:\"â\",nabla:\"â\",isin:\"â\",notin:\"â\",ni:\"â\",prod:\"â\",sum:\"â\",minus:\"â\",lowast:\"â\",radic:\"â\",prop:\"â\",infin:\"â\",ang:\"â \",and:\"â§\",or:\"â¨\",cap:\"â©\",cup:\"âª\",int:\"â«\",there4:\"â´\",sim:\"â¼\",cong:\"â\",asymp:\"â\",ne:\"â \",equiv:\"â¡\",le:\"â¤\",ge:\"â¥\",sub:\"â\",sup:\"â\",nsub:\"â\",sube:\"â\",supe:\"â\",oplus:\"â\",otimes:\"â\",perp:\"â¥\",sdot:\"â\",Alpha:\"Î\",Beta:\"Î\",Gamma:\"Î\",Delta:\"Î\",Epsilon:\"Î\",Zeta:\"Î\",Eta:\"Î\",Theta:\"Î\",Iota:\"Î\",Kappa:\"Î\",Lambda:\"Î\",Mu:\"Î\",Nu:\"Î\",Xi:\"Î\",Omicron:\"Î\",Pi:\"Î \",Rho:\"Î¡\",Sigma:\"Î£\",Tau:\"Î¤\",Upsilon:\"Î¥\",Phi:\"Î¦\",Chi:\"Î§\",Psi:\"Î¨\",Omega:\"Î©\",alpha:\"Î±\",beta:\"Î²\",gamma:\"Î³\",delta:\"Î´\",epsilon:\"Îµ\",zeta:\"Î¶\",eta:\"Î·\",theta:\"Î¸\",iota:\"Î¹\",kappa:\"Îº\",lambda:\"Î»\",mu:\"Î¼\",nu:\"Î½\",xi:\"Î¾\",omicron:\"Î¿\",pi:\"Ï\",rho:\"Ï\",sigmaf:\"Ï\",sigma:\"Ï\",tau:\"Ï\",upsilon:\"Ï\",phi:\"Ï\",chi:\"Ï\",psi:\"Ï\",omega:\"Ï\",thetasym:\"Ï\",upsih:\"Ï\",piv:\"Ï\",OElig:\"Å\",oelig:\"Å\",Scaron:\"Å \",scaron:\"Å¡\",Yuml:\"Å¸\",fnof:\"Æ\",circ:\"Ë\",tilde:\"Ë\",ensp:\"â\",emsp:\"â\",thinsp:\"â\",zwnj:\"â\",zwj:\"â\",lrm:\"â\",rlm:\"â\",ndash:\"â\",mdash:\"â\",lsquo:\"â\",rsquo:\"â\",sbquo:\"â\",ldquo:\"â\",rdquo:\"â\",bdquo:\"â\",dagger:\"â \",Dagger:\"â¡\",bull:\"â¢\",hellip:\"â¦\",permil:\"â°\",prime:\"â²\",Prime:\"â³\",lsaquo:\"â¹\",rsaquo:\"âº\",oline:\"â¾\",euro:\"â¬\",trade:\"â¢\",larr:\"â\",uarr:\"â\",rarr:\"â\",darr:\"â\",harr:\"â\",crarr:\"âµ\",lceil:\"â\",rceil:\"â\",lfloor:\"â\",rfloor:\"â\",loz:\"â\",spades:\"â \",clubs:\"â£\",hearts:\"â¥\",diams:\"â¦\"}),t.entityMap=t.HTML_ENTITIES},function(e,t,r){function n(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,n)}function o(){}function a(e,t,r,o,a){function p(e){var t=e.slice(1,-1);return Object.hasOwnProperty.call(r,t)?r[t]:\"#\"===t.charAt(0)?function(e){var t=String.fromCharCode;return 65535<e?t(55296+((e-=65536)>>10),56320+(1023&e)):t(e)}(parseInt(t.substr(1).replace(\"x\",\"0x\"))):(a.error(\"entity not found:\"+e),e)}function g(t){if(t>O){var r=e.substring(O,t).replace(/&#?\\w+;/g,p);w&&v(O),o.characters(r,0,t-O),O=t}}function v(t,r){for(;t>=b&&(r=x.exec(e));)y=r.index,b=y+r[0].length,w.lineNumber++;w.columnNumber=t-y+1}for(var y=0,b=0,x=/.*(?:\\r\\n?|\\n)|.*$/g,w=o.locator,T=[{currentNSMap:t}],E={},O=0;;){try{var N=e.indexOf(\"<\",O);if(0>N){if(!e.substr(O).match(/^\\s*$/)){var P=o.doc,S=P.createTextNode(e.substr(O));P.appendChild(S),o.currentElement=S}return}switch(N>O&&g(N),e.charAt(N+1)){case\"/\":var I=e.indexOf(\">\",N+3),A=e.substring(N+2,I).replace(/[ \\t\\n\\r]+$/g,\"\"),C=T.pop();0>I?(A=e.substring(N+2).replace(/[\\s<].*/,\"\"),a.error(\"end tag name: \"+A+\" is not complete:\"+C.tagName),I=N+1+A.length):A.match(/\\s</)&&(A=A.replace(/[\\s<].*/,\"\"),a.error(\"end tag name: \"+A+\" maybe not complete\"),I=N+1+A.length);var M=C.localNSMap,D=C.tagName==A;if(D||C.tagName&&C.tagName.toLowerCase()==A.toLowerCase()){if(o.endElement(C.uri,C.localName,A),M)for(var k in M)o.endPrefixMapping(k);D||a.fatalError(\"end tag name: \"+A+\" is not match the current start tagName:\"+C.tagName)}else T.push(C);I++;break;case\"?\":w&&v(N),I=h(e,N,o);break;case\"!\":w&&v(N),I=f(e,N,o,a);break;default:w&&v(N);var _=new d,j=T[T.length-1].currentNSMap,L=(I=s(e,N,_,j,p,a),_.length);if(!_.closed&&c(e,I,_.tagName,E)&&(_.closed=!0,!r.nbsp&&a.warning(\"unclosed xml attribute\")),w&&L){for(var R,F=i(w,{}),U=0;U<L;U++)v((R=_[U]).offset),R.locator=i(w,{});o.locator=F,u(_,o,j)&&T.push(_),o.locator=w}else u(_,o,j)&&T.push(_);m.isHTML(_.uri)&&!_.closed?I=l(e,I,_.tagName,p,o):I++}}catch(t){if(t instanceof n)throw t;a.error(\"element parse error: \"+t),I=-1}I>O?O=I:g(Math.max(N,O)+1)}}function i(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function s(e,t,r,n,o,a){function i(e,t,n){r.attributeNames.hasOwnProperty(e)&&a.fatalError(\"Attribute \"+e+\" redefined\"),r.addValue(e,t.replace(/[\\t\\n\\r]/g,\" \").replace(/&#?\\w+;/g,o),n)}for(var s,u=++t,l=b;;){var c=e.charAt(u);switch(c){case\"=\":if(l==x)s=e.slice(t,u),l=T;else{if(l!=w)throw new Error(\"attribute equal must after attrName\");l=T}break;case\"'\":case'\"':if(l==T||l==x){if(l==x&&(a.warning('attribute value must after \"=\"'),s=e.slice(t,u)),t=u+1,!(0<(u=e.indexOf(c,t))))throw new Error(\"attribute value no end '\"+c+\"' match\");i(s,p=e.slice(t,u),t-1),l=O}else{if(l!=E)throw new Error('attribute value must after \"=\"');i(s,p=e.slice(t,u),t),a.warning('attribute \"'+s+'\" missed start quot('+c+\")!!\"),t=u+1,l=O}break;case\"/\":switch(l){case b:r.setTagName(e.slice(t,u));case O:case N:case P:l=P,r.closed=!0;case E:case x:case w:break;default:throw new Error(\"attribute invalid close char('/')\")}break;case\"\":return a.error(\"unexpected end of input\"),l==b&&r.setTagName(e.slice(t,u)),u;case\">\":switch(l){case b:r.setTagName(e.slice(t,u));case O:case N:case P:break;case E:case x:\"/\"===(p=e.slice(t,u)).slice(-1)&&(r.closed=!0,p=p.slice(0,-1));case w:l==w&&(p=s),l==E?(a.warning('attribute \"'+p+'\" missed quot(\")!'),i(s,p,t)):((!m.isHTML(n[\"\"])||!p.match(/^(?:disabled|checked|selected)$/i))&&a.warning('attribute \"'+p+'\" missed value!! \"'+p+'\" instead!!'),i(p,p,t));break;case T:throw new Error(\"attribute value missed!!\")}return u;case\"Â\":c=\" \";default:if(\" \">=c)switch(l){case b:r.setTagName(e.slice(t,u)),l=N;break;case x:s=e.slice(t,u),l=w;break;case E:var p=e.slice(t,u);a.warning('attribute \"'+p+'\" missed quot(\")!!'),i(s,p,t);case O:l=N}else switch(l){case w:r.tagName,m.isHTML(n[\"\"])&&s.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute \"'+s+'\" missed value!! \"'+s+'\" instead2!!'),i(s,s,t),t=u,l=x;break;case O:a.warning('attribute space is required\"'+s+'\"!!');case N:l=x,t=u;break;case T:l=E,t=u;break;case P:throw new Error(\"elements closed character '/' and '>' must be connected to\")}}u++}}function u(e,t,r){for(var n=e.tagName,o=null,a=e.length;a--;){var i=e[a],s=i.qName,u=i.value;if(0<(h=s.indexOf(\":\")))var l=i.prefix=s.slice(0,h),c=s.slice(h+1),f=\"xmlns\"===l&&c;else c=s,l=null,f=\"xmlns\"===s&&\"\";i.localName=c,!1!==f&&(null==o&&(o={},p(r,r={})),r[f]=o[f]=u,i.uri=m.XMLNS,t.startPrefixMapping(f,u))}for(a=e.length;a--;){(l=(i=e[a]).prefix)&&(\"xml\"===l&&(i.uri=m.XML),\"xmlns\"!==l&&(i.uri=r[l||\"\"]))}var h;0<(h=n.indexOf(\":\"))?(l=e.prefix=n.slice(0,h),c=e.localName=n.slice(h+1)):(l=null,c=e.localName=n);var d=e.uri=r[l||\"\"];if(t.startElement(d,c,n,e),!e.closed)return e.currentNSMap=r,e.localNSMap=o,!0;if(t.endElement(d,c,n),o)for(l in o)t.endPrefixMapping(l)}function l(e,t,r,n,o){if(/^(?:script|textarea)$/i.test(r)){var a=e.indexOf(\"</\"+r+\">\",t),i=e.substring(t+1,a);if(/[&<]/.test(i))return/^script$/i.test(r)?(o.characters(i,0,i.length),a):(i=i.replace(/&#?\\w+;/g,n),o.characters(i,0,i.length),a)}return t+1}function c(e,t,r,n){var o=n[r];return null==o&&((o=e.lastIndexOf(\"</\"+r+\">\"))<t&&(o=e.lastIndexOf(\"</\"+r)),n[r]=o),o<t}function p(e,t){for(var r in e)t[r]=e[r]}function f(e,t,r,n){switch(e.charAt(t+2)){case\"-\":return\"-\"===e.charAt(t+3)?(o=e.indexOf(\"--\\x3e\",t+4))>t?(r.comment(e,t+4,o-t-4),o+3):(n.error(\"Unclosed comment\"),-1):-1;default:if(\"CDATA[\"==e.substr(t+3,6)){var o=e.indexOf(\"]]>\",t+9);return r.startCDATA(),r.characters(e,t+9,o-t-9),r.endCDATA(),o+3}var a=function(e,t){var r,n=[],o=/'[^']+'|\"[^\"]+\"|[^\\s<>\\/=]+=?|(\\/?\\s*>|<)/g;for(o.lastIndex=t,o.exec(e);r=o.exec(e);)if(n.push(r),r[1])return n}(e,t),i=a.length;if(1<i&&/!doctype/i.test(a[0][0])){var s=a[1][0],u=!1,l=!1;3<i&&(/^public$/i.test(a[2][0])?(u=a[3][0],l=4<i&&a[4][0]):/^system$/i.test(a[2][0])&&(l=a[3][0]));var c=a[i-1];return r.startDTD(s,u,l),r.endDTD(),c.index+c[0].length}}return-1}function h(e,t,r){var n=e.indexOf(\"?>\",t);if(n){var o=e.substring(t,n).match(/^<\\?(\\S*)\\s*([\\s\\S]*?)\\s*$/);return o?(o[0].length,r.processingInstruction(o[1],o[2]),n+2):-1}return-1}function d(){this.attributeNames={}}var m=r(3).NAMESPACE,g=/[A-Z_a-z\\xC0-\\xD6\\xD8-\\xF6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]/,v=new RegExp(\"[\\\\-\\\\.0-9\"+g.source.slice(1,-1)+\"\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040]\"),y=new RegExp(\"^\"+g.source+v.source+\"*(?::\"+g.source+v.source+\"*)?$\"),b=0,x=1,w=2,T=3,E=4,O=5,N=6,P=7;n.prototype=new Error,n.prototype.name=n.name,o.prototype={parse:function(e,t,r){var n=this.domBuilder;n.startDocument(),p(t,t={}),a(e,t,r,n,this.errorHandler),n.endDocument()}},d.prototype={setTagName:function(e){if(!y.test(e))throw new Error(\"invalid tagName:\"+e);this.tagName=e},addValue:function(e,t,r){if(!y.test(e))throw new Error(\"invalid attribute:\"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=o,t.ParseError=n},function(e,t,r){\"use strict\";function n(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function o(e,t){for(var r,n=e.length>>>0,o=0;o<n;o++)if(r=e[o],t.call(this,r,o,e))return r}var a=r(1).getScopeParserExecutionError,i=r(4).last,s=r(0).concatArrays,u=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,e),this.root=t.root||this,this.resolveOffset=t.resolveOffset||0,this.scopePath=t.scopePath,this.scopePathItem=t.scopePathItem,this.scopePathLength=t.scopePathLength,this.scopeList=t.scopeList,this.scopeLindex=t.scopeLindex,this.parser=t.parser,this.resolved=t.resolved,this.cachedParsers=t.cachedParsers}return function(e,t,r){t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,\"prototype\",{writable:!1})}(e,[{key:\"loopOver\",value:function(e,t,r,n){return this.loopOverValue(this.getValue(e,n),t,r)}},{key:\"functorIfInverted\",value:function(e,t,r,n,o){return e&&t(r,n,o),e}},{key:\"isValueFalsy\",value:function(e,t){return null==e||!e||\"[object Array]\"===t&&0===e.length}},{key:\"loopOverValue\",value:function(e,t,r){this.root.finishedResolving&&(r=!1);var n=Object.prototype.toString.call(e);if(this.isValueFalsy(e,n))return this.functorIfInverted(r,t,i(this.scopeList),0,1);if(\"[object Array]\"===n){for(var o=0;o<e.length;o++)this.functorIfInverted(!r,t,e[o],o,e.length);return!0}return\"[object Object]\"===n?this.functorIfInverted(!r,t,e,0,1):this.functorIfInverted(!r,t,i(this.scopeList),0,1)}},{key:\"getValue\",value:function(e,t){var r=function e(t,r,n){var i,s,u=this,l=this.scopeList[n];if(this.root.finishedResolving){var c=this.resolved;return this.scopePath.slice(this.resolveOffset).forEach(function(e,t){var r=u.scopeLindex[t];c=(c=o(c,function(e){return e.lIndex===r})).value[u.scopePathItem[t]]}),o(c,function(e){return r.part.lIndex===e.lIndex}).value}s=this.cachedParsers&&r.part?this.cachedParsers[r.part.lIndex]?this.cachedParsers[r.part.lIndex]:this.cachedParsers[r.part.lIndex]=this.parser(t,{scopePath:this.scopePath}):this.parser(t,{scopePath:this.scopePath});try{i=s.get(l,this.getContext(r,n))}catch(n){throw a({tag:t,scope:l,error:n,offset:r.part.offset})}return null==i&&0<n?e.call(this,t,r,n-1):i}.call(this,e,t,this.scopeList.length-1);return\"function\"==typeof r?r(this.scopeList[this.scopeList.length-1],this):r}},{key:\"getValueAsync\",value:function(e,t){var r=this;return function e(t,r,n){var o,i=this,s=this.scopeList[n];return o=this.cachedParsers&&r.part?this.cachedParsers[r.part.lIndex]?this.cachedParsers[r.part.lIndex]:this.cachedParsers[r.part.lIndex]=this.parser(t,{scopePath:this.scopePath}):this.parser(t,{scopePath:this.scopePath}),Promise.resolve().then(function(){return o.get(s,i.getContext(r,n))}).catch(function(e){throw a({tag:t,scope:s,error:e,offset:r.part.offset})}).then(function(o){return null==o&&0<n?e.call(i,t,r,n-1):o})}.call(this,e,t,this.scopeList.length-1).then(function(e){return\"function\"==typeof e?e(r.scopeList[r.scopeList.length-1],r):e})}},{key:\"getContext\",value:function(e,t){return{num:t,meta:e,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:\"createSubScopeManager\",value:function(t,r,n,o,a){return new e({root:this.root,resolveOffset:this.resolveOffset,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeList:s([this.scopeList,[t]]),scopePath:s([this.scopePath,[r]]),scopePathItem:s([this.scopePathItem,[n]]),scopePathLength:s([this.scopePathLength,[a]]),scopeLindex:s([this.scopeLindex,[o.lIndex]])})}}]),e}();e.exports=function(e){return e.scopePath=[],e.scopePathItem=[],e.scopePathLength=[],e.scopeLindex=[],e.scopeList=[e.tags],new u(e)}},function(e){\"use strict\";function t(e,t){return t instanceof Error?Object.getOwnPropertyNames(t).concat(\"stack\").reduce(function(e,r){return e[r]=t[r],\"stack\"===r&&(e[r]=t[r].toString()),e},{}):t}e.exports=function(e,r){if(console.log(JSON.stringify({error:e},t,\"json\"===r?2:null)),e.properties&&e.properties.errors instanceof Array){var n=e.properties.errors.map(function(e){return e.properties.explanation}).join(\"\\n\");console.log(\"errorMessages\",n)}}},function(e){\"use strict\";e.exports=function(e,t,r){for(var n={},o=0,a=e.length;o<a;o++){var i=e[o],s=i.getAttribute(\"ContentType\"),u=i.getAttribute(\"PartName\").substr(1);n[u]=s}for(var l=function(e){var o=t[e],a=o.getAttribute(\"ContentType\"),i=o.getAttribute(\"Extension\");r.file(/./).map(function(e){var t=e.name;t.slice(t.length-i.length)!==i||n[t]||\"[Content_Types].xml\"===t||(n[t]=a)})},c=0,p=t.length;c<p;c++)l(c);return n}},function(e,t,r){\"use strict\";function n(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}var o=r(2),a=r(6),i=[\"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml\",\"application/vnd.openxmlformats-package.core-properties+xml\",\"application/vnd.openxmlformats-officedocument.extended-properties+xml\",\"application/vnd.openxmlformats-officedocument.custom-properties+xml\"],s=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,e),this.name=\"Common\"}return function(e,t,r){t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,\"prototype\",{writable:!1})}(e,[{key:\"getFileType\",value:function(e){var t=e.doc,r=t.invertedContentTypes;if(r){for(var n,o,s=Object.keys(a),u=0,l=s.length;u<l;u++)for(var c,p=0,f=(o=a[s[u]]).length;p<f;p++)r[c=o[p]]&&(n=s[u],Array.prototype.push.apply(t.targets,r[c]));for(var h,d=0,m=i.length;d<m;d++)r[h=i[d]]&&Array.prototype.push.apply(t.targets,r[h]);return n}}}]),e}();e.exports=function(){return o(new s)}},function(e,t,r){\"use strict\";function n(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}var o=r(0),a=o.wordToUtf8,i=o.convertSpaces,s=r(9),u=r(8),l=r(21),c=r(23),p=r(24),f=r(25),h=r(26);e.exports=function(){function e(t,r){var n=this;(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,e),this.cachedParsers={},this.content=t,Object.keys(r).forEach(function(e){n[e]=r[e]}),this.setModules({inspect:{filePath:r.filePath}})}return function(e,t,r){t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,\"prototype\",{writable:!1})}(e,[{key:\"resolveTags\",value:function(e){var t=this;this.tags=e;var r=this.getOptions(),n=this.filePath;return r.scopeManager=this.scopeManager,r.resolve=f,f(r).then(function(e){var o=e.resolved,a=e.errors;if(a.forEach(function(e){e.properties=e.properties||{},e.properties.file=n}),0!==a.length)throw a;return Promise.all(o).then(function(e){return r.scopeManager.root.finishedResolving=!0,r.scopeManager.resolved=e,t.setModules({inspect:{resolved:e,filePath:n}}),e})})}},{key:\"getFullText\",value:function(){return e=this.content,t=this.fileTypeConfig.tagsXmlTextArray,r=s(e,t).matches.map(function(e){return e.array[2]}),a(i(r.join(\"\")));var e,t,r}},{key:\"setModules\",value:function(e){this.modules.forEach(function(t){t.set(e)})}},{key:\"preparse\",value:function(){this.allErrors=[],this.xmllexed=u.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{xmllexed:this.xmllexed}});var e=u.parse(this.xmllexed,this.delimiters),t=e.lexed,r=e.errors;this.allErrors=this.allErrors.concat(r),this.lexed=t,this.setModules({inspect:{lexed:this.lexed}});var n=this.getOptions();l.preparse(this.lexed,this.modules,n)}},{key:\"parse\",value:function(){this.setModules({inspect:{filePath:this.filePath}});var e=this.getOptions();this.parsed=l.parse(this.lexed,this.modules,e),this.setModules({inspect:{parsed:this.parsed}});var t=l.postparse(this.parsed,this.modules,e),r=t.postparsed,n=t.errors;return this.postparsed=r,this.setModules({inspect:{postparsed:this.postparsed}}),this.allErrors=this.allErrors.concat(n),this.errorChecker(this.allErrors),this}},{key:\"errorChecker\",value:function(e){var t=this;e.forEach(function(e){e.properties=e.properties||{},e.properties.file=t.filePath}),this.modules.forEach(function(t){e=t.errorsTransformer(e)})}},{key:\"baseNullGetter\",value:function(e,t){var r=this,n=this.modules.reduce(function(n,o){return null==n?o.nullGetter(e,t,r):n},null);return null==n?this.nullGetter(e,t):n}},{key:\"getOptions\",value:function(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,fileType:this.fileType,linebreaks:this.linebreaks}}},{key:\"render\",value:function(e){this.filePath=e;var t=this.getOptions();t.resolved=this.scopeManager.resolved,t.scopeManager=this.scopeManager,t.render=c,t.joinUncorrupt=h;var r=c(t),n=r.errors,o=r.parts;return 0<n.length?(this.allErrors=n,this.errorChecker(n),this):(this.content=p(o,t),this.setModules({inspect:{content:this.content}}),this)}}]),e}()},function(e,t,r){\"use strict\";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e){for(var t,r=1;r<arguments.length;r++)t=null==arguments[r]?{}:arguments[r],r%2?n(Object(t),!0).forEach(function(r){a(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))});return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(e,t)||u(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function s(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function u(e,t){if(e){if(\"string\"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===r&&e.constructor&&(r=e.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r,n=[],o=0,a=e.length;o<a;o++)if((r=e[o]).matchers){var i=r.matchers(t);if(!(i instanceof Array))throw new Error(\"module matcher returns a non array\");n.push.apply(n,s(i))}return n}function p(e,t,r){for(var n=[],a=0,s=e.length;a<s;a++){var u=e[a],l=i(u,2),c=l[0],p=l[1],f=u[2]||{};if(r.match(c,t)){var h=r.getValues(c,t);if(\"function\"==typeof f&&(f=f(h)),!f.value){var d=i(h,2);f.value=d[1]}n.push(o({type:\"placeholder\",prefix:c,module:p,onMatch:f.onMatch,priority:f.priority},f))}}return n}var f=r(0).wordToUtf8,h=r(22),d=h.match,m=h.getValue,g=h.getValues;e.exports={preparse:function(e,t,r){return{preparsed:function(e,r){return t.forEach(function(t){t.preparse(e,r)})}(e,r)}},parse:function(e,t,r){var n,a=!1,i=\"\",s=[],u=r.fileTypeConfig.droppedTagsInsidePlaceholder||[];return e.reduce(function(e,l){return\"delimiter\"===l.type?(a=\"start\"===l.position,\"end\"===l.position&&(r.parse=function(e){return function(e,t){var r,n=t.modules,o=t.startOffset,a=t.lIndex;t.offset=o,t.match=d,t.getValue=m,t.getValues=g;var i=p(c(n,t),e,t);if(0<i.length){var s=null;return i.forEach(function(e){e.priority=e.priority||-e.value.length,(!s||e.priority>s.priority)&&(s=e)}),s.offset=o,delete s.priority,s.endLindex=a,s.lIndex=a,s.raw=e,s.onMatch&&s.onMatch(s),delete s.onMatch,delete s.prefix,s}for(var u=0,l=n.length;u<l;u++)if(r=n[u].parse(e,t))return r.offset=o,r.endLindex=a,r.lIndex=a,r.raw=e,r;return{type:\"placeholder\",value:e,offset:o,endLindex:a,lIndex:a}}(e,o(o(o({},r),l),{},{startOffset:n,modules:t}))},e.push(r.parse(f(i))),Array.prototype.push.apply(e,s),s=[]),\"start\"===l.position&&(s=[],n=l.offset),i=\"\",e):a?\"content\"!==l.type||\"insidetag\"!==l.position?-1===u.indexOf(l.tag)?(s.push(l),e):e:(i+=l.value,e):(e.push(l),e)},[])},postparse:function(e,t,r){function n(e,r){return t.map(function(t){return t.getTraits(e,r)})}var a=[];return{postparsed:function e(r,i){return t.reduce(function(t,r){var s=r.postparse(t,o(o({},i),{},{postparse:function(t,r){return e(t,o(o({},i),r))},getTraits:n}));return null==s?t:s.errors?(Array.prototype.push.apply(a,s.errors),s.postparsed):s},r)}(e,r),errors:a}}}},function(e){\"use strict\";function t(e){return e.replace(r,\" \")}var r=/Â /g;e.exports={match:function(e,r){return\"string\"==typeof e?t(r.substr(0,e.length))===e:e instanceof RegExp?e.test(t(r)):void 0},getValue:function(e,r){return\"string\"==typeof e?t(r).substr(e.length):e instanceof RegExp?t(r).match(e)[1]:void 0},getValues:function(e,r){return\"string\"==typeof e?[r,t(r).substr(e.length)]:e instanceof RegExp?t(r).match(e):void 0}}},function(e,t,r){\"use strict\";var n=r(1).throwUnimplementedTagType;e.exports=function(e){var t=e.baseNullGetter,r=e.compiled,o=e.scopeManager;e.nullGetter=function(e,r){return t(e,r||o)};var a=[],i=r.map(function(t,r){e.index=r;var o=function(e,t){for(var r,n=0,o=t.modules.length;n<o;n++)if(r=t.modules[n].render(e,t))return r;return!1}(t,e);return o?(o.errors&&Array.prototype.push.apply(a,o.errors),o):\"content\"===t.type||\"tag\"===t.type?t:void n(t,r)}).reduce(function(e,t){var r=t.value;if(r instanceof Array)for(var n=0,o=r.length;n<o;n++)e.push(r[n]);else r&&e.push(r);return e},[]);return{errors:a,parts:i}}},function(e){\"use strict\";function t(e){var t,r,n,o,a=0,i=e.length;for(n=0;n<i;n++)55296==(64512&(t=e.charCodeAt(n)))&&n+1<i&&(56320==(64512&(r=e.charCodeAt(n+1)))&&(t=65536+(t-55296<<10)+(r-56320),n++)),a+=128>t?1:2048>t?2:65536>t?3:4;var s=new Uint8Array(a);for(o=0,n=0;o<a;n++)55296==(64512&(t=e.charCodeAt(n)))&&n+1<i&&(56320==(64512&(r=e.charCodeAt(n+1)))&&(t=65536+(t-55296<<10)+(r-56320),n++)),128>t?s[o++]=t:2048>t?(s[o++]=192|t>>>6,s[o++]=128|63&t):65536>t?(s[o++]=224|t>>>12,s[o++]=128|63&t>>>6,s[o++]=128|63&t):(s[o++]=240|t>>>18,s[o++]=128|63&t>>>12,s[o++]=128|63&t>>>6,s[o++]=128|63&t);return s}e.exports=function(e,r){for(var n=0,o=r.modules.length;n<o;n++)e=r.modules[n].postrender(e,r);for(var a,i=0,s=r.joinUncorrupt(e,r),u=\"\",l=0,c=[],p=0,f=s.length;p<f;p++){if((a=s[p]).length+l>65536){var h=t(u);i+=h.length,c.push(h),u=\"\"}u+=a,l+=a.length,delete s[p]}var d=t(u);i+=d.length,c.push(d);var m=new Uint8Array(i),g=0;return c.forEach(function(e){for(var t=0;t<e.length;++t)m[t+g]=e[t];g+=e.length}),m}},function(e){\"use strict\";function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||function(e,t){if(e){if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===n&&e.constructor&&(n=e.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}e.exports=function(e){var r=[],n=e.baseNullGetter,o=e.compiled,a=e.scopeManager;e.nullGetter=function(e,t){return n(e,t||a)},e.resolved=r;var i=[];return Promise.all(o.filter(function(e){return-1===[\"content\",\"tag\"].indexOf(e.type)}).reduce(function(n,o){var s,u=function(e,t){for(var r,n=0,o=t.modules.length;n<o;n++)if(r=t.modules[n].resolve(e,t))return r;return!1}(o,e);if(u)s=u.then(function(e){r.push({tag:o.value,value:e,lIndex:o.lIndex})});else{if(\"placeholder\"!==o.type)return;s=a.getValueAsync(o.value,{part:o}).then(function(t){return null==t&&(t=e.nullGetter(o)),r.push({tag:o.value,value:t,lIndex:o.lIndex}),t})}return n.push(s.catch(function(e){e instanceof Array?i.push.apply(i,t(e)):i.push(e)})),n},[])).then(function(){return{errors:i,resolved:r}})}},function(e,t,r){\"use strict\";function n(e){for(var t,r=\"\",n=0,o=e.length;n<o;n++)t=e[n],!l(t)&&(!i(r,\"</w:tbl>\")||a(t,\"<w:p\")||a(t,\"<w:tbl\")||a(t,\"<w:sectPr\")||(t=\"<w:p/>\".concat(t)),r=t,e[n]=t);return e}var o=r(0),a=o.startsWith,i=o.endsWith,s=o.isStarting,u=o.isEnding,l=o.isWhiteSpace,c=r(6);e.exports=function(e,t){var r=t.fileTypeConfig.tagShouldContain||[],o=\"\",a=-1;-1!==c.docx.indexOf(t.contentType)&&(e=n(e));for(var i,l=-1,p=0,f=e.length;p<f;p++){i=e[p];for(var h=0,d=r.length;h<d;h++){var m=r[h],g=m.tag,v=m.shouldContain,y=m.value,b=m.drop;if(a===h){if(u(i,g)){if(a=-1,b)for(var x=l;x<=p;x++)e[x]=\"\";else{for(var w=l;w<p;w++)e[w]=\"\";e[p]=o+y+i}break}o+=i;for(var T,E=0,O=v.length;E<O;E++)if(T=v[E],s(i,T)){a=-1;break}break}if(-1==a&&s(i,g)&&-1===i.substr(1).indexOf(\"<\")){if(\"/\"===i[i.length-2]){e[p]=\"\";break}l=p,a=h,o=i;break}}}return e}},function(e,t,r){\"use strict\";var n=r(28),o=r(29),a=r(30),i=r(31),s=r(33);e.exports={docx:function(){return{getTemplatedFiles:function(){return[]},textPath:function(e){return e.targets[0]},tagsXmlTextArray:[\"Company\",\"HyperlinkBase\",\"Manager\",\"cp:category\",\"cp:keywords\",\"dc:creator\",\"dc:description\",\"dc:subject\",\"dc:title\",\"cp:contentStatus\",\"w:t\",\"m:t\",\"vt:lpstr\",\"vt:lpwstr\"],tagsXmlLexedArray:[\"w:proofState\",\"w:tc\",\"w:tr\",\"w:tbl\",\"w:body\",\"w:document\",\"w:p\",\"w:r\",\"w:br\",\"w:rPr\",\"w:pPr\",\"w:spacing\",\"w:sdtContent\",\"w:drawing\",\"w:sectPr\",\"w:type\",\"w:headerReference\",\"w:footerReference\",\"w:bookmarkStart\",\"w:bookmarkEnd\"],droppedTagsInsidePlaceholder:[\"w:p\",\"w:br\",\"w:bookmarkStart\",\"w:bookmarkEnd\"],expandTags:[{contains:\"w:tc\",expand:\"w:tr\"}],onParagraphLoop:[{contains:\"w:p\",expand:\"w:p\",onlyTextInTag:!0}],tagRawXml:\"w:p\",baseModules:[n,o,i,a,s],tagShouldContain:[{tag:\"w:tbl\",shouldContain:[\"w:tr\"],drop:!0},{tag:\"w:tc\",shouldContain:[\"w:p\"],value:\"<w:p></w:p>\"},{tag:\"w:sdtContent\",shouldContain:[\"w:p\",\"w:r\"],value:\"<w:p></w:p>\"}]}},pptx:function(){return{getTemplatedFiles:function(){return[]},textPath:function(e){return e.targets[0]},tagsXmlTextArray:[\"Company\",\"HyperlinkBase\",\"Manager\",\"cp:category\",\"cp:keywords\",\"dc:creator\",\"dc:description\",\"dc:subject\",\"dc:title\",\"a:t\",\"m:t\",\"vt:lpstr\",\"vt:lpwstr\"],tagsXmlLexedArray:[\"p:sp\",\"a:tc\",\"a:tr\",\"a:tbl\",\"a:p\",\"a:r\",\"a:rPr\",\"p:txBody\",\"a:txBody\",\"a:off\",\"a:ext\",\"p:graphicFrame\",\"p:xfrm\",\"a16:rowId\",\"a:endParaRPr\"],droppedTagsInsidePlaceholder:[\"a:p\",\"a:endParaRPr\"],expandTags:[{contains:\"a:tc\",expand:\"a:tr\"}],onParagraphLoop:[{contains:\"a:p\",expand:\"a:p\",onlyTextInTag:!0}],tagRawXml:\"p:sp\",baseModules:[n,i,a,s],tagShouldContain:[{tag:\"a:tbl\",shouldContain:[\"a:tr\"],drop:!0},{tag:\"p:txBody\",shouldContain:[\"a:p\"],value:\"<a:p></a:p>\"},{tag:\"a:txBody\",shouldContain:[\"a:p\"],value:\"<a:p></a:p>\"}]}}}},function(e,t,r){\"use strict\";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e){for(var t,r=1;r<arguments.length;r++)t=null==arguments[r]?{}:arguments[r],r%2?n(Object(t),!0).forEach(function(r){a(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))});return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(e,t)||u(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function u(e,t){if(e){if(\"string\"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===r&&e.constructor&&(r=e.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function p(e){var t=function(e){for(var t=0,r=e.length;t<r;t++)if(\"content\"!==e[t].type)return e[t];return null}(e.subparsed);return null!=t&&\"w:t\"!==t.tag}function f(e){return e.hasPageBreak&&p(e)?'<w:p><w:r><w:br w:type=\"page\"/></w:r></w:p>':\"\"}function h(e){return function(e){return e.some(function(e){return E(e)})}(e)?0:e.length}function d(e){var t=e.parts.length-1;\"</w:p>\"===e.parts[t]?e.parts.splice(t,0,'<w:r><w:br w:type=\"page\"/></w:r>'):e.parts.push('<w:p><w:r><w:br w:type=\"page\"/></w:r></w:p>')}function m(e){return e.some(function(e){return\"w:br\"===e.tag&&-1!==e.value.indexOf('w:type=\"page\"')})}function g(e){return e.some(function(e){return\"w:drawing\"===e.tag})}var v=r(0),y=v.chunkBy,b=v.last,x=v.isParagraphStart,w=v.isModule,T=v.isParagraphEnd,E=v.isContent,O=v.startsWith,N=v.isTagEnd,P=v.isTagStart,S=v.getSingleAttribute,I=v.setSingleAttribute,A=r(6),C=r(2),M=\"loop\",D=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,e),this.name=\"LoopModule\",this.inXfrm=!1,this.totalSectPr=0,this.prefix={start:\"#\",end:\"/\",dash:/^-([^\\s]+)\\s(.+)/,inverted:\"^\"}}return function(e,t,r){t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,\"prototype\",{writable:!1})}(e,[{key:\"optionsTransformer\",value:function(e,t){return this.docxtemplater=t,e}},{key:\"preparse\",value:function(e,t){var r=t.contentType;-1!==A.main.indexOf(r)&&(this.sects=function(e){var t=!1,r=[];return e.forEach(function(e){P(\"w:sectPr\",e)&&(r.push([]),t=!0),t&&r[r.length-1].push(e),N(\"w:sectPr\",e)&&(t=!1)}),r}(e))}},{key:\"matchers\",value:function(){var e=M;return[[this.prefix.start,e,{expandTo:\"auto\",location:\"start\",inverted:!1}],[this.prefix.inverted,e,{expandTo:\"auto\",location:\"start\",inverted:!0}],[this.prefix.end,e,{location:\"end\"}],[this.prefix.dash,e,function(e){var t=s(e,3);return{location:\"start\",inverted:!1,expandTo:t[1],value:t[2]}}]]}},{key:\"getTraits\",value:function(e,t){return\"expandPair\"===e?t.reduce(function(e,t,r){return w(t,M)&&null==t.subparsed&&e.push({part:t,offset:r}),e},[]):void 0}},{key:\"postparse\",value:function(e,t){var r=t.basePart;if(r&&\"docx\"===this.docxtemplater.fileType){r.sectPrCount=function(e){var t=!1,r=0;return e.forEach(function(e){P(\"w:sectPr\",e)&&(t=!0),t&&(\"w:headerReference\"===e.tag||\"w:footerReference\"===e.tag)&&(r++,t=!1),N(\"w:sectPr\",e)&&(t=!1)}),r}(e),this.totalSectPr+=r.sectPrCount;var n=this.sects;n.some(function(t,o){return t[0].lIndex>r.lIndex?(o+1<n.length&&function(e){return e.some(function(e){return P(\"w:type\",e)&&-1!==e.value.indexOf(\"continuous\")})}(n[o+1])&&(r.addContinuousType=!0),!0):t[0].lIndex>e[0].lIndex&&r.lIndex>t[0].lIndex?(function(e){return e.some(function(e){return P(\"w:type\",e)&&-1!==e.value.indexOf('w:val=\"nextPage\"')})}(n[o])&&(r.addNextPage={index:o}),!0):void 0}),r.lastParagrapSectPr=function(e){for(var t,r=[],n=!1,o=e.length-1;0<=o;o--)if(t=e[o],N(\"w:sectPr\",t)&&(n=!0),P(\"w:sectPr\",t)&&(r.unshift(t.value),n=!1),n&&r.unshift(t.value),x(t)){if(0<r.length)return r.join(\"\");break}return\"\"}(e)}if(!r||\"auto\"!==r.expandTo||r.module!==M||!function(e){return e.length&&x(e[0])&&T(b(e))}(e))return e;r.paragraphLoop=!0;var o=0,a=y(e,function(e){return x(e)&&1==++o?\"start\":T(e)&&0==--o?\"end\":null}),i=a[0],s=b(a),u=h(i),l=h(s);return r.hasPageBreakBeginning=m(i),r.hasPageBreak=m(s),g(i)&&(u=0),g(s)&&(l=0),e.slice(u,e.length-l)}},{key:\"resolve\",value:function(e,t){function r(r,o,i){var s=n.createSubScopeManager(r,e.value,o,e,i);a.push(t.resolve({filePath:t.filePath,modules:t.modules,baseNullGetter:t.baseNullGetter,resolve:t.resolve,compiled:e.subparsed,tags:{},scopeManager:s}))}if(!w(e,M))return null;var n=t.scopeManager,o=n.getValueAsync(e.value,{part:e}),a=[],s=[];return o.then(function(t){return new Promise(function(e){t instanceof Array?Promise.all(t).then(e):e(t)}).then(function(t){return n.loopOverValue(t,r,e.inverted),Promise.all(a).then(function(e){return e.map(function(e){var t=e.resolved,r=e.errors;return s.push.apply(s,i(r)),t})}).then(function(e){if(0<s.length)throw s;return e})})})}},{key:\"render\",value:function(e,t){if(\"p:xfrm\"===e.tag&&(this.inXfrm=\"start\"===e.position),\"a:ext\"===e.tag&&this.inXfrm)return this.lastExt=e,e;if(!w(e,M))return null;var r=[],n=[],a=0,i=this,s=e.subparsed[0],u=0;\"a:tr\"===(null==s?void 0:s.tag)&&(u=+S(s.value,\"h\")),a-=u;var l=0,c=p(e);if(!1===t.scopeManager.loopOver(e.value,function(s,p,f){a+=u;var h=t.scopeManager.createSubScopeManager(s,e.value,p,e,f);e.subparsed.forEach(function(e){if(P(\"a16:rowId\",e)){var t=+S(e.value,\"val\")+l;l=1,e.value=I(e.value,\"val\",t)}});var m=t.render(o(o({},t),{},{compiled:e.subparsed,tags:{},scopeManager:h}));e.hasPageBreak&&p===f-1&&c&&d(m),h.scopePathItem.some(function(e){return 0!==e})?(1===e.sectPrCount&&(m.parts=function(e){return e.filter(function(e){return!O(e,\"<w:headerReference\")&&!O(e,\"<w:footerReference\")})}(m.parts)),e.addContinuousType&&(m.parts=function(e){var t=!1,r=!1;return e.reduce(function(e,n){return 0==t&&O(n,\"<w:sectPr\")&&(r=!0),r&&(O(n,\"<w:type\")&&(t=!0),0==t&&O(n,\"</w:sectPr\")&&e.push('<w:type w:val=\"continuous\"/>')),e.push(n),e},[])}(m.parts))):e.addNextPage&&(m.parts=function(e,t){return[\"<w:p><w:pPr>\".concat(t.map(function(e){return e.value}).join(\"\"),\"</w:pPr></w:p>\")].concat(e)}(m.parts,i.sects[e.addNextPage.index])),e.addNextPage&&d(m),e.hasPageBreakBeginning&&c&&function(e){e.parts.unshift('<w:p><w:r><w:br w:type=\"page\"/></w:r></w:p>')}(m);for(var g=0,v=m.parts.length;g<v;g++)r.push(m.parts[g]);Array.prototype.push.apply(n,m.errors)},e.inverted,{part:e}))return e.lastParagrapSectPr?e.paragraphLoop?{value:\"<w:p><w:pPr>\".concat(e.lastParagrapSectPr,\"</w:pPr></w:p>\")}:{value:\"</w:t></w:r></w:p><w:p><w:pPr>\".concat(e.lastParagrapSectPr,\"</w:pPr><w:r><w:t>\")}:{value:f(e)||\"\",errors:n};if(0!=a){var h=+S(this.lastExt.value,\"cy\");this.lastExt.value=I(this.lastExt.value,\"cy\",h+a)}return{value:t.joinUncorrupt(r,o(o({},t),{},{basePart:e})),errors:n}}}]),e}();e.exports=function(){return C(new D)}},function(e,t,r){\"use strict\";function n(e){return s(e)&&\"w:t\"===e.tag}function o(e,t){var r=e[t].value;return\"</w:t>\"===e[t+1].value?r:-1===r.indexOf('xml:space=\"preserve\"')?r.substr(0,r.length-1)+' xml:space=\"preserve\">':r}var a=r(2),i=r(0),s=i.isTextStart,u=i.isTextEnd,l=i.endsWith,c=i.startsWith,p='<w:t xml:space=\"preserve\">',f=p.length,h=\"</w:t>\",d=h.length,m={name:\"SpacePreserveModule\",postparse:function(e,t){var r=[],a=!1,i=0,s=0,l=e.reduce(function(e,l){return n(l)&&(a=!0,s=r.length),a?(r.push(l),function(e,t){return e&&e.basePart&&1<t.length}(t,r)&&(i=t.basePart.endLindex,r[0].value=o(r,0)),function(e,t){return\"placeholder\"===e.type&&1<t.length}(l,r)&&(r[s].value=o(r,s),i=l.endLindex),u(l)&&l.lIndex>i&&(0!==i&&(r[s].value=o(r,s)),Array.prototype.push.apply(e,r),r=[],a=!1,i=0,s=0),e):(e.push(l),e)},[]);return Array.prototype.push.apply(l,r),l},postrender:function(e){for(var t=\"\",r=0,n=0,o=e.length;n<o;n++){var a=n,i=e[n];\"\"!==i&&(l(t,p)&&c(i,h)&&(e[r]=t.substr(0,t.length-f)+\"<w:t/>\",i=i.substr(d)),t=i,r=a,e[n]=i)}return e}};e.exports=function(){return a(m)}},function(e,t,r){\"use strict\";function n(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function o(e){var t=e.part,r=e.left,n=e.right,o=e.postparsed,a=e.index,s=o.slice(r+1,n);return s.forEach(function(e,n){n===a-r-1||i(e)&&u({paragraphParts:s,part:t})}),t}var a=r(5),i=r(0).isContent,s=r(1),u=s.throwRawTagShouldBeOnlyTextInParagraph,l=s.getInvalidRawXMLValueException,c=\"rawxml\",p=r(2),f=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,e),this.name=\"RawXmlModule\",this.prefix=\"@\"}return function(e,t,r){t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,\"prototype\",{writable:!1})}(e,[{key:\"optionsTransformer\",value:function(e,t){return this.fileTypeConfig=t.fileTypeConfig,e}},{key:\"matchers\",value:function(){return[[this.prefix,c]]}},{key:\"postparse\",value:function(e){return a.expandToOne(e,{moduleName:c,getInner:o,expandTo:this.fileTypeConfig.tagRawXml,error:{message:\"Raw tag not in paragraph\",id:\"raw_tag_outerxml_invalid\",explanation:function(e){return'The tag \"'.concat(e.value,'\" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:\"render\",value:function(e,t){if(e.module!==c)return null;var r,n=[];try{null==(r=t.scopeManager.getValue(e.value,{part:e}))&&(r=t.nullGetter(e))}catch(t){return n.push(t),{errors:n}}return\"string\"==typeof(r=r||\"\")?{value:r}:{errors:[l({tag:e.value,value:r,offset:e.offset})]}}}]),e}();e.exports=function(){return p(new f)}},function(e,t,r){\"use strict\";function n(e){switch(e.location){case\"start\":return 1;case\"end\":return-1}}function o(e,t){return null!=e&&null!=t&&(\"start\"===e.part.location&&\"end\"===t.part.location&&e.part.value===t.part.value||\"\"===t.part.value)}function a(e){for(var t,r=0,n=[];r<e.length;){if(\"end\"===(t=e[r].part).location){if(0==r)return e.splice(0,1),n.push(d(t)),{traits:e,errors:n};var a=r,i=r-1,s=1;if(o(e[i],e[a]))return e.splice(a,1),e.splice(i,1),{errors:n,traits:e};for(;50>s;){var u=e[i-s],l=e[a+s];if(o(u,e[a]))return e.splice(a,1),e.splice(i-s,1),{errors:n,traits:e};if(o(e[i],l))return e.splice(a+s,1),e.splice(i,1),{errors:n,traits:e};s++}return n.push(m({tags:[e[i].part,e[a].part]})),e.splice(a,1),e.splice(i,1),{traits:e,errors:n}}r++}return e.forEach(function(e){var t=e.part;n.push(d(t))}),{traits:[],errors:n}}function i(e){for(var t={},r=[],o=[],i=[],s=0;s<e.length;s++)i.push(e[s]);for(;0<i.length;){var u=a(i);r=r.concat(u.errors),i=u.traits}if(0<r.length)return{pairs:o,errors:r};for(var l=0,c=0;c<e.length;c++){var p=e[c],f=n(p.part);if(l+=f,1===f)t[l]=p;else{var h=t[l+1];0===l&&(o=o.concat([[h,p]]))}l=0<=l?l:0}return{pairs:o,errors:r}}var s=r(32),u=r(0),l=u.getLeft,c=u.getRight,p=r(2),f=r(5).getExpandToDefault,h=r(1),d=h.getUnmatchedLoopException,m=h.getClosingTagNotMatchOpeningTag,g=h.getUnbalancedLoopException,v={name:\"ExpandPairTrait\",optionsTransformer:function(e,t){return this.expandTags=t.fileTypeConfig.expandTags.concat(t.options.paragraphLoop?t.fileTypeConfig.onParagraphLoop:[]),e},postparse:function(e,t){var r=this,n=t.getTraits,o=t.postparse,a=n(\"expandPair\",e);a=a.map(function(e){return e||[]});var u=i(a=s(a)),p=u.pairs,h=u.errors,d=0,m=null,v=p.map(function(t){var n,o,a=t[0].part.expandTo;if(\"auto\"===a){var i=f(e,t,r.expandTags);i.error&&h.push(i.error),a=i.value}if(!a){var s=t[0].offset,u=t[1].offset;return s<d&&h.push(g(t,m)),m=t,d=u,[s,u]}try{n=l(e,a,t[0].offset)}catch(t){h.push(t)}try{o=c(e,a,t[1].offset)}catch(t){h.push(t)}return n<d&&h.push(g(t,m)),d=o,m=t,[n,o]});if(0<h.length)return{postparsed:e,errors:h};var y,b=0;return{postparsed:e.reduce(function(t,r,n){var a=b<p.length&&v[b][0]<=n&&n<=v[b][1],i=p[b],s=v[b];if(!a)return t.push(r),t;if(s[0]===n&&(y=[]),i[0].offset!==n&&i[1].offset!==n&&y.push(r),s[1]===n){var u=e[i[0].offset];u.subparsed=o(y,{basePart:u}),delete u.location,delete u.expandTo,t.push(u),b++}return t},[]),errors:h}}};e.exports=function(){return p(v)}},function(e){\"use strict\";function t(e,t){for(var r=-1,n=0,o=e.length;n<o;n++)t[n]>=e[n].length||(-1==r||e[n][t[n]].offset<e[r][t[r]].offset)&&(r=n);return r}e.exports=function(e){var r=e.reduce(function(e,t){return e+t.length},0);e=e.filter(function(e){return 0<e.length});for(var n,o=Array(r),a=e.map(function(){return 0}),i=0;i<r;i++)n=t(e,a),o[i]=e[n][a[n]],a[n]++;return o}},function(e,t,r){\"use strict\";function n(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}var o=r(2),a=r(1).getScopeCompilationError,i=r(0),s=i.utf8ToWord,u=i.hasCorruptCharacters,l=r(1).getCorruptCharactersException,c={docx:\"w\",pptx:\"a\"},p=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,e),this.name=\"Render\",this.recordRun=!1,this.recordedRun=[]}return function(e,t,r){t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,\"prototype\",{writable:!1})}(e,[{key:\"optionsTransformer\",value:function(e,t){return this.parser=t.parser,this.fileType=t.fileType,e}},{key:\"set\",value:function(e){e.compiled&&(this.compiled=e.compiled),null!=e.data&&(this.data=e.data)}},{key:\"getRenderedMap\",value:function(e){var t=this;return Object.keys(this.compiled).reduce(function(e,r){return e[r]={from:r,data:t.data},e},e)}},{key:\"postparse\",value:function(e,t){var r=this,n=[];return e.forEach(function(e){if(\"placeholder\"===e.type){var o=e.value;try{t.cachedParsers[e.lIndex]=r.parser(o,{tag:e})}catch(t){n.push(a({tag:o,rootError:t,offset:e.offset}))}}}),{postparsed:e,errors:n}}},{key:\"render\",value:function(e,t){var r=t.scopeManager,n=t.linebreaks,o=t.nullGetter;if(n&&this.recordRuns(e),\"placeholder\"===e.type&&!e.module){var a;try{a=r.getValue(e.value,{part:e})}catch(t){return{errors:[t]}}return null==a&&(a=o(e)),u(a)?{errors:[l({tag:e.value,value:a,offset:e.offset})]}:{value:n&&\"string\"==typeof a?this.renderLineBreaks(a):s(a)}}}},{key:\"recordRuns\",value:function(e){e.tag===\"\".concat(c[this.fileType],\":r\")?this.recordedRun=[]:e.tag===\"\".concat(c[this.fileType],\":rPr\")?(\"start\"===e.position&&(this.recordRun=!0,this.recordedRun=[e.value]),\"end\"===e.position&&(this.recordedRun.push(e.value),this.recordRun=!1)):this.recordRun&&this.recordedRun.push(e.value)}},{key:\"renderLineBreaks\",value:function(e){var t=this,r=c[this.fileType],n=\"docx\"===this.fileType?\"<w:r><w:br/></w:r>\":\"<a:br/>\",o=e.split(\"\\n\"),a=this.recordedRun.join(\"\");return o.map(function(e){return s(e)}).reduce(function(e,i,s){return e.push(i),s<o.length-1&&e.push(\"</\".concat(r,\":t></\").concat(r,\":r>\").concat(n,\"<\").concat(r,\":r>\").concat(a,\"<\").concat(r,\":t\").concat(\"docx\"===t.fileType?' xml:space=\"preserve\"':\"\",\">\")),e},[])}}]),e}();e.exports=function(){return o(new p)}}]);","extractedComments":[]}